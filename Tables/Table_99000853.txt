OBJECT Table 99000853 Inventory Profile
{
  OBJECT-PROPERTIES
  {
    Date=09/15/15;
    Time=12:00:00 PM;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Inventory Profile;
               ESM=Perfil inventario;
               FRC=Profil du stock;
               ENC=Inventory Profile];
  }
  FIELDS
  {
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              ESM=Nß l°nea;
                                                              FRC=N¯ ligne;
                                                              ENC=Line No.] }
    { 4   ;   ;Attribute Priority  ;Integer       ;CaptionML=[ENU=Attribute Priority;
                                                              ESM=Prioridad atributo;
                                                              FRC=PrioritÇ d'attribut;
                                                              ENC=Attribute Priority] }
    { 5   ;   ;Order Priority      ;Integer       ;CaptionML=[ENU=Order Priority;
                                                              ESM=Prioridad pedido;
                                                              FRC=PrioritÇ de commande;
                                                              ENC=Order Priority] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              ESM=Nß producto;
                                                              FRC=N¯ d'article;
                                                              ENC=Item No.] }
    { 12  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.),
                                                                                            Code=FIELD(Variant Code));
                                                   CaptionML=[ENU=Variant Code;
                                                              ESM=C¢d. variante;
                                                              FRC=Code variante;
                                                              ENC=Variant Code] }
    { 13  ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   CaptionML=[ENU=Location Code;
                                                              ESM=C¢d. almacÇn;
                                                              FRC=Code d'emplacement;
                                                              ENC=Location Code] }
    { 14  ;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   CaptionML=[ENU=Bin Code;
                                                              ESM=C¢d. ubicaci¢n;
                                                              FRC=Code de zone;
                                                              ENC=Bin Code] }
    { 15  ;   ;IsSupply            ;Boolean       ;CaptionML=[ENU=IsSupply;
                                                              ESM=EsSuministro;
                                                              FRC=IsSupply;
                                                              ENC=IsSupply] }
    { 16  ;   ;Order Relation      ;Option        ;CaptionML=[ENU=Order Relation;
                                                              ESM=Relaci¢n pedido;
                                                              FRC=Lien commande;
                                                              ENC=Order Relation];
                                                   OptionCaptionML=[ENU=Normal,Safety Stock,Reorder Point;
                                                                    ESM=Normal,Existencias seguridad,Punto de pedido;
                                                                    FRC=Normal,Stock sÇcuritÇ,Point de commande;
                                                                    ENC=Normal,Safety Stock,Reorder Point];
                                                   OptionString=Normal,Safety Stock,Reorder Point }
    { 21  ;   ;Source Type         ;Integer       ;CaptionML=[ENU=Source Type;
                                                              ESM=Tipo procedencia mov.;
                                                              FRC=Type origine;
                                                              ENC=Source Type] }
    { 22  ;   ;Source Order Status ;Integer       ;CaptionML=[ENU=Source Order Status;
                                                              ESM=Estado orden origen;
                                                              FRC=êtat commande origine;
                                                              ENC=Source Order Status] }
    { 23  ;   ;Source ID           ;Code20        ;CaptionML=[ENU=Source ID;
                                                              ESM=Id. origen;
                                                              FRC=Code origine;
                                                              ENC=Source ID] }
    { 24  ;   ;Source Batch Name   ;Code10        ;CaptionML=[ENU=Source Batch Name;
                                                              ESM=Nombre secci¢n origen;
                                                              FRC=Nom de lot source;
                                                              ENC=Source Batch Name] }
    { 25  ;   ;Source Ref. No.     ;Integer       ;CaptionML=[ENU=Source Ref. No.;
                                                              ESM=Nß ref. origen;
                                                              FRC=N¯ de rÇfÇrence source;
                                                              ENC=Source Ref. No.] }
    { 26  ;   ;Source Prod. Order Line;Integer    ;CaptionML=[ENU=Source Prod. Order Line;
                                                              ESM=L°nea O.P. origen;
                                                              FRC=Ligne bon de production origine;
                                                              ENC=Source Prod. Order Line] }
    { 27  ;   ;Primary Order Status;Integer       ;CaptionML=[ENU=Primary Order Status;
                                                              ESM=Estado orden primaria;
                                                              FRC=êtat commande temporaire;
                                                              ENC=Primary Order Status] }
    { 28  ;   ;Primary Order No.   ;Code20        ;CaptionML=[ENU=Primary Order No.;
                                                              ESM=Nß orden primaria;
                                                              FRC=Nß commande temporaire;
                                                              ENC=Primary Order No.] }
    { 29  ;   ;Primary Order Line  ;Integer       ;CaptionML=[ENU=Primary Order Line;
                                                              ESM=L°nea orden primaria;
                                                              FRC=Ligne commande temporaire;
                                                              ENC=Primary Order Line] }
    { 30  ;   ;Primary Order Type  ;Integer       ;CaptionML=[ENU=Primary Order Type;
                                                              ESM=Tipo orden primaria;
                                                              FRC=Type commande primaire;
                                                              ENC=Primary Order Type] }
    { 31  ;   ;Original Quantity   ;Decimal       ;CaptionML=[ENU=Original Quantity;
                                                              ESM=Cantidad original;
                                                              FRC=QuantitÇ initiale;
                                                              ENC=Original Quantity];
                                                   DecimalPlaces=0:5 }
    { 32  ;   ;Remaining Quantity (Base);Decimal  ;CaptionML=[ENU=Remaining Quantity (Base);
                                                              ESM=Cantidad pendiente (base);
                                                              FRC=QuantitÇ restante (base);
                                                              ENC=Remaining Quantity (Base)];
                                                   DecimalPlaces=0:5 }
    { 33  ;   ;Untracked Quantity  ;Decimal       ;CaptionML=[ENU=Untracked Quantity;
                                                              ESM=Cantidad no seguida;
                                                              FRC=QuantitÇ non assortie;
                                                              ENC=Untracked Quantity];
                                                   DecimalPlaces=0:5 }
    { 34  ;   ;Original Due Date   ;Date          ;CaptionML=[ENU=Original Due Date;
                                                              ESM=Fecha vencim. orig.;
                                                              FRC=êchÇance initiale;
                                                              ENC=Original Due Date] }
    { 35  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              ESM=Fecha vencimiento;
                                                              FRC=Date d'ÇchÇance;
                                                              ENC=Due Date] }
    { 36  ;   ;Planning Flexibility;Option        ;CaptionML=[ENU=Planning Flexibility;
                                                              ESM=Flexib. planificaci¢n;
                                                              FRC=FlexibilitÇ de planification;
                                                              ENC=Planning Flexibility];
                                                   OptionCaptionML=[ENU=Unlimited,None,Reduce Only;
                                                                    ESM=Ilimitada,Ninguna,S¢lo reducir;
                                                                    FRC=IllimitÇ,Aucun,RÇduire uniquement;
                                                                    ENC=Unlimited,None,Reduce Only];
                                                   OptionString=Unlimited,None,Reduce Only }
    { 37  ;   ;Fixed Date          ;Date          ;CaptionML=[ENU=Fixed Date;
                                                              ESM=Fecha fija;
                                                              FRC=Date fixe;
                                                              ENC=Fixed Date] }
    { 38  ;   ;Action Message      ;Option        ;CaptionML=[ENU=Action Message;
                                                              ESM=Mensaje acci¢n;
                                                              FRC=Message d'action;
                                                              ENC=Action Message];
                                                   OptionCaptionML=[ENU=" ,New,Change Qty.,Reschedule,Resched.& Chg. Qty.,Cancel";
                                                                    ESM=" ,Nuevo,Cambiar cdad.,Reprogramar,Reprog. y camb. cdad.,Cancelar";
                                                                    FRC=" ,Nouveau,Modifier qtÇ,RÇÇchelonner,RÇÇchelonner & modifier qtÇ,Annuler";
                                                                    ENC=" ,New,Change Qty.,Reschedule,Resched.& Chg. Qty.,Cancel"];
                                                   OptionString=[ ,New,Change Qty.,Reschedule,Resched.& Chg. Qty.,Cancel] }
    { 39  ;   ;Binding             ;Option        ;CaptionML=[ENU=Binding;
                                                              ESM=Atado;
                                                              FRC=Consolidation;
                                                              ENC=Binding];
                                                   OptionCaptionML=[ENU=" ,Order-to-Order";
                                                                    ESM=" ,Pedido contra pedido";
                                                                    FRC=" ,Commande Ö commande";
                                                                    ENC=" ,Order-to-Order"];
                                                   OptionString=[ ,Order-to-Order];
                                                   Editable=No }
    { 40  ;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              ESM=Cantidad (base);
                                                              FRC=QuantitÇ (base);
                                                              ENC=Quantity (Base)];
                                                   DecimalPlaces=0:5 }
    { 41  ;   ;Min. Quantity       ;Decimal       ;CaptionML=[ENU=Min. Quantity;
                                                              ESM=Cdad. m°nima;
                                                              FRC=QuantitÇ min.;
                                                              ENC=Min. Quantity];
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              ESM=Fecha inicial;
                                                              FRC=Date dÇbut;
                                                              ENC=Starting Date] }
    { 43  ;   ;Planning Line No.   ;Integer       ;CaptionML=[ENU=Planning Line No.;
                                                              ESM=Nß l°nea planif.;
                                                              FRC=Nß ligne planification;
                                                              ENC=Planning Line No.] }
    { 44  ;   ;Unit of Measure Code;Code10        ;CaptionML=[ENU=Unit of Measure Code;
                                                              ESM=C¢d. unidad medida;
                                                              FRC=Code unitÇ de mesure;
                                                              ENC=Unit of Measure Code] }
    { 45  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              ESM=Cdad. por unidad medida;
                                                              FRC=QuantitÇ par unitÇ de mesure;
                                                              ENC=Qty. per Unit of Measure];
                                                   DecimalPlaces=0:5 }
    { 46  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              ESM=Cantidad;
                                                              FRC=QuantitÇ;
                                                              ENC=Quantity];
                                                   DecimalPlaces=0:5 }
    { 47  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              ESM=Cantidad pendiente;
                                                              FRC=QuantitÇ restante;
                                                              ENC=Remaining Quantity];
                                                   DecimalPlaces=0:5 }
    { 48  ;   ;Finished Quantity   ;Decimal       ;CaptionML=[ENU=Finished Quantity;
                                                              ESM=Cantidad terminada;
                                                              FRC=QuantitÇ achevÇe;
                                                              ENC=Finished Quantity];
                                                   DecimalPlaces=0:5 }
    { 50  ;   ;Planning Level Code ;Integer       ;CaptionML=[ENU=Planning Level Code;
                                                              ESM=C¢d. nivel planif.;
                                                              FRC=Code niveau planification;
                                                              ENC=Planning Level Code];
                                                   Editable=No }
    { 51  ;   ;Planning Line Phase ;Option        ;CaptionML=[ENU=Planning Line Phase;
                                                              ESM=Fase l°nea planif.;
                                                              FRC=Phase ligne planification;
                                                              ENC=Planning Line Phase];
                                                   OptionCaptionML=[ENU=" ,Line Created,Routing Created,Exploded";
                                                                    ESM=" ,L°nea creada,Ruta creada,Desplegada";
                                                                    FRC=" ,Ligne crÇÇe,ItinÇraire crÇÇ,êclatÇ";
                                                                    ENC=" ,Line Created,Routing Created,Exploded"];
                                                   OptionString=[ ,Line Created,Routing Created,Exploded] }
    { 52  ;   ;Due Time            ;Time          ;CaptionML=[ENU=Due Time;
                                                              ESM=Tiempo fin.;
                                                              FRC=Heure ÇchÇance;
                                                              ENC=Due Time] }
    { 53  ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              ESM=Venta a-Nß cliente;
                                                              FRC=N¯ client (dÇbiteur);
                                                              ENC=Sell-to Customer No.] }
    { 54  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              ESM=Env°o directo;
                                                              FRC=Livraison directe;
                                                              ENC=Drop Shipment] }
    { 55  ;   ;Special Order       ;Boolean       ;CaptionML=[ENU=Special Order;
                                                              ESM=Pedido especial;
                                                              FRC=Commande spÇciale;
                                                              ENC=Special Order] }
    { 56  ;   ;Ref. Order No.      ;Code20        ;CaptionML=[ENU=Ref. Order No.;
                                                              ESM=Nß orden ref.;
                                                              FRC=Nß comm. rÇf.;
                                                              ENC=Ref. Order No.];
                                                   Editable=No }
    { 57  ;   ;Ref. Line No.       ;Integer       ;CaptionML=[ENU=Ref. Line No.;
                                                              ESM=Nß l°n. ref.;
                                                              FRC=N¯ ligne rÇfÇrence;
                                                              ENC=Ref. Line No.];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 58  ;   ;Derived from Blanket Order;Boolean ;CaptionML=[ENU=Derived from Blanket Order;
                                                              ESM=Proviene de ped. abierto;
                                                              FRC=Issue de commande ouverte;
                                                              ENC=Derived from Blanket Order] }
    { 59  ;   ;Ref. Blanket Order No.;Code20      ;CaptionML=[ENU=Ref. Blanket Order No.;
                                                              ESM=Nß ped. abierto ref.;
                                                              FRC=N¯ cde ouverte rÇf.;
                                                              ENC=Ref. Blanket Order No.] }
    { 60  ;   ;Tracking Reference  ;Integer       ;CaptionML=[ENU=Tracking Reference;
                                                              ESM=Referencia seguimiento;
                                                              FRC=RÇfÇrence suivi;
                                                              ENC=Tracking Reference] }
    { 61  ;   ;Lot No.             ;Code20        ;CaptionML=[ENU=Lot No.;
                                                              ESM=Nß lote;
                                                              FRC=N¯ de lot;
                                                              ENC=Lot No.] }
    { 62  ;   ;Serial No.          ;Code20        ;CaptionML=[ENU=Serial No.;
                                                              ESM=Nß serie;
                                                              FRC=N¯ de sÇrie;
                                                              ENC=Serial No.] }
    { 63  ;   ;Max. Quantity       ;Decimal       ;CaptionML=[ENU=Max. Quantity;
                                                              ESM=Cantidad m†x.;
                                                              FRC=QuantitÇ maximale;
                                                              ENC=Max. Quantity];
                                                   DecimalPlaces=0:5 }
    { 64  ;   ;Safety Stock Quantity;Decimal      ;CaptionML=[ENU=Safety Stock Quantity;
                                                              ESM=Inventario de seguridad;
                                                              FRC=QuantitÇ de stocks de sÇcuritÇ;
                                                              ENC=Safety Stock Quantity];
                                                   DecimalPlaces=0:5 }
    { 65  ;   ;Is Exception Order  ;Boolean       ;CaptionML=[ENU=Is Exception Order;
                                                              ESM=Pedido excepci¢n;
                                                              FRC=Est une commande d'exception;
                                                              ENC=Is Exception Order] }
    { 66  ;   ;Transfer Location Not Planned;Boolean;
                                                   CaptionML=[ENU=Transfer Location Not Planned;
                                                              ESM=Alm. transferencia no planificada;
                                                              FRC=Emplacement de transfert non planifiÇ;
                                                              ENC=Transfer Location Not Planned] }
    { 67  ;   ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              ESM=Fecha caducidad;
                                                              FRC=Date d'expiration;
                                                              ENC=Expiration Date];
                                                   Editable=No }
    { 68  ;   ;Ref. Order Type     ;Option        ;CaptionML=[ENU=Ref. Order Type;
                                                              ESM=Tipo orden ref.;
                                                              FRC=Type comm. rÇf.;
                                                              ENC=Ref. Order Type];
                                                   OptionCaptionML=[ENU=" ,Purchase,Prod. Order,Transfer,Assembly";
                                                                    ESM=" ,Compra,Orden prod.,Transferencia,Ensamblado";
                                                                    FRC=" ,Achat,Bon de production,Transfert,Assemblage";
                                                                    ENC=" ,Purchase,Prod. Order,Transfer,Assembly"];
                                                   OptionString=[ ,Purchase,Prod. Order,Transfer,Assembly];
                                                   Editable=No }
    { 69  ;   ;Disallow Cancellation;Boolean      ;CaptionML=[ENU=Disallow Cancelation;
                                                              ESM=No permitir cancelaci¢n;
                                                              FRC=Interdire l'annulation;
                                                              ENC=Disallow Cancellation] }
    { 70  ;   ;MPS Order           ;Boolean       ;CaptionML=[ENU=MPS Order;
                                                              ESM=Orden MPS;
                                                              FRC=Ordre PDP;
                                                              ENC=MPS Order] }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
    {    ;Item No.,Variant Code,Location Code,Due Date,Attribute Priority,Order Priority }
    {    ;Item No.,Variant Code,Location Code,IsSupply,Primary Order Status,Primary Order No.,Due Date,Order Priority }
    {    ;Source Type,Source Order Status,Source ID,Source Batch Name,Source Ref. No.,Source Prod. Order Line,IsSupply,Due Date }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Tab99000853, TransferToTrackingEntry: Illegal Source Type: %1.;ESM=Tab99000853, TransfDesdeMovSeguimien: Tipo fuente incorrecta: %1.;FRC=Tab99000853, TransfertêcritureSuivi : Type de source incorrect : %1.;ENC=Tab99000853, TransferToTrackingEntry: Illegal Source Type: %1.';

    PROCEDURE TransferFromItemLedgerEntry@1(VAR ItemLedgerEntry@1000 : Record 32;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveItemLedgerEntry@1002 : Codeunit 99000841;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Item Ledger Entry";
      "Source Ref. No." := ItemLedgerEntry."Entry No.";
      "Item No." := ItemLedgerEntry."Item No.";
      "Variant Code" := ItemLedgerEntry."Variant Code";
      "Location Code" := ItemLedgerEntry."Location Code";
      Quantity := ItemLedgerEntry.Quantity;
      "Remaining Quantity" := ItemLedgerEntry."Remaining Quantity";
      "Finished Quantity" := Quantity - "Remaining Quantity";
      "Quantity (Base)" := ItemLedgerEntry.Quantity;
      "Remaining Quantity (Base)" := ItemLedgerEntry."Remaining Quantity";
      ItemLedgerEntry.CALCFIELDS("Reserved Quantity");
      ReserveItemLedgerEntry.FilterReservFor(ReservEntry,ItemLedgerEntry);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        ItemLedgerEntry."Remaining Quantity" -
        ItemLedgerEntry."Reserved Quantity" +
        AutoReservedQty;
      "Unit of Measure Code" := ItemLedgerEntry."Unit of Measure Code";
      "Qty. per Unit of Measure" := 1;
      IsSupply := ItemLedgerEntry.Positive;
      "Due Date" := ItemLedgerEntry."Posting Date";
      "Lot No." := ItemLedgerEntry."Lot No.";
      "Serial No." := ItemLedgerEntry."Serial No.";
      IF TrackingExists THEN
        "Tracking Reference" := "Line No.";
      "Planning Flexibility" := "Planning Flexibility"::None;
    END;

    PROCEDURE TransferFromSalesLine@2(VAR SalesLine@1000 : Record 37;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveSalesLine@1002 : Codeunit 99000832;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      SalesLine.TESTFIELD(Type,SalesLine.Type::Item);
      "Source Type" := DATABASE::"Sales Line";
      "Source Order Status" := SalesLine."Document Type";
      "Source ID" := SalesLine."Document No.";
      "Source Ref. No." := SalesLine."Line No.";
      "Item No." := SalesLine."No.";
      "Variant Code" := SalesLine."Variant Code";
      "Location Code" := SalesLine."Location Code";
      "Bin Code" := SalesLine."Bin Code";
      SalesLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveSalesLine.FilterReservFor(ReservEntry,SalesLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingEntry);
      IF SalesLine."Document Type" = SalesLine."Document Type"::"Return Order" THEN BEGIN
        SalesLine."Reserved Qty. (Base)" := -SalesLine."Reserved Qty. (Base)";
        AutoReservedQty := -AutoReservedQty;
      END;
      "Untracked Quantity" :=
        SalesLine."Outstanding Qty. (Base)" -
        SalesLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := SalesLine.Quantity;
      "Remaining Quantity" := SalesLine."Outstanding Quantity";
      "Finished Quantity" := SalesLine."Quantity Shipped";
      "Quantity (Base)" := SalesLine."Quantity (Base)";
      "Remaining Quantity (Base)" := SalesLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := SalesLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := SalesLine."Qty. per Unit of Measure";
      IF SalesLine."Document Type" = SalesLine."Document Type"::"Return Order" THEN
        ChangeSign;
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := SalesLine."Shipment Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
      IF SalesLine."Blanket Order No." <> '' THEN BEGIN
        "Sell-to Customer No." := SalesLine."Sell-to Customer No.";
        "Derived from Blanket Order" := TRUE;
        "Ref. Blanket Order No." := SalesLine."Blanket Order No.";
      END;
      "Drop Shipment" := SalesLine."Drop Shipment";
      "Special Order" := SalesLine."Special Order";
    END;

    PROCEDURE TransferFromComponent@7(VAR ProdOrderComp@1000 : Record 5407;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveProdOrderComp@1002 : Codeunit 99000838;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Prod. Order Component";
      "Source Order Status" := ProdOrderComp.Status;
      "Source ID" := ProdOrderComp."Prod. Order No.";
      "Source Prod. Order Line" := ProdOrderComp."Prod. Order Line No.";
      "Source Ref. No." := ProdOrderComp."Line No.";
      "Ref. Order Type" := "Ref. Order Type"::"Prod. Order";
      "Ref. Order No." := ProdOrderComp."Prod. Order No.";
      "Ref. Line No." := ProdOrderComp."Prod. Order Line No.";
      "Item No." := ProdOrderComp."Item No.";
      "Variant Code" := ProdOrderComp."Variant Code";
      "Location Code" := ProdOrderComp."Location Code";
      "Bin Code" := ProdOrderComp."Bin Code";
      "Due Date" := ProdOrderComp."Due Date";
      "Due Time" := ProdOrderComp."Due Time";
      "Planning Flexibility" := "Planning Flexibility"::None;
      "Planning Level Code" := ProdOrderComp."Planning Level Code";
      ProdOrderComp.CALCFIELDS("Reserved Qty. (Base)");
      IF ProdOrderComp.Status IN [ProdOrderComp.Status::Released,ProdOrderComp.Status::Finished] THEN
        ProdOrderComp.CALCFIELDS("Act. Consumption (Qty)");
      ReserveProdOrderComp.FilterReservFor(ReservEntry,ProdOrderComp);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        ProdOrderComp."Remaining Qty. (Base)" -
        ProdOrderComp."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := ProdOrderComp."Expected Quantity";
      "Remaining Quantity" := ProdOrderComp."Remaining Quantity";
      "Finished Quantity" := ProdOrderComp."Act. Consumption (Qty)";
      "Quantity (Base)" := ProdOrderComp."Expected Qty. (Base)";
      "Remaining Quantity (Base)" := ProdOrderComp."Remaining Qty. (Base)";
      "Unit of Measure Code" := ProdOrderComp."Unit of Measure Code";
      "Qty. per Unit of Measure" := ProdOrderComp."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
    END;

    PROCEDURE TransferFromPlanComponent@8(VAR PlanComponent@1000 : Record 99000829;VAR TrackingEntry@1008 : Record 337);
    VAR
      ProdOrderComp@1001 : Record 5407;
      AsmLine@1009 : Record 901;
      ReservEntry@1002 : Record 337;
      ReservePlanningComponent@1003 : Codeunit 99000840;
      ReserveProdOrderComp@1004 : Codeunit 99000838;
      AsmLineReserve@1007 : Codeunit 926;
      ReservedQty@1005 : Decimal;
      AutoReservedQty@1006 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Planning Component";
      "Source ID" := PlanComponent."Worksheet Template Name";
      "Source Batch Name" := PlanComponent."Worksheet Batch Name";
      "Source Prod. Order Line" := PlanComponent."Worksheet Line No.";
      "Source Ref. No." := PlanComponent."Line No.";
      "Source Order Status" := PlanComponent."Ref. Order Status";
      "Ref. Order Type" := PlanComponent."Ref. Order Type";
      "Ref. Order No." := PlanComponent."Ref. Order No.";
      "Ref. Line No." := PlanComponent."Ref. Order Line No.";
      "Item No." := PlanComponent."Item No.";
      "Variant Code" := PlanComponent."Variant Code";
      "Location Code" := PlanComponent."Location Code";
      "Bin Code" := PlanComponent."Bin Code";
      "Due Date" := PlanComponent."Due Date";
      "Due Time" := PlanComponent."Due Time";
      "Planning Flexibility" := "Planning Flexibility"::None;
      "Planning Level Code" := PlanComponent."Planning Level Code";
      ReservePlanningComponent.FilterReservFor(ReservEntry,PlanComponent);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        PlanComponent."Expected Quantity (Base)" -
        PlanComponent."Reserved Qty. (Base)" +
        AutoReservedQty;
      CASE PlanComponent."Ref. Order Type" OF
        PlanComponent."Ref. Order Type"::"Prod. Order":
          IF ProdOrderComp.GET(
               PlanComponent."Ref. Order Status",
               PlanComponent."Ref. Order No.",
               PlanComponent."Ref. Order Line No.",
               PlanComponent."Line No.")
          THEN BEGIN
            "Original Quantity" := ProdOrderComp."Expected Quantity";
            ProdOrderComp.CALCFIELDS("Reserved Qty. (Base)");
            IF ProdOrderComp."Reserved Qty. (Base)" > 0 THEN BEGIN
              ReservedQty := ProdOrderComp."Reserved Qty. (Base)";
              ReserveProdOrderComp.FilterReservFor(ReservEntry,ProdOrderComp);
              CalcReservedQty(ReservEntry,ReservedQty);
              IF ReservedQty > "Untracked Quantity" THEN
                "Untracked Quantity" := 0
              ELSE
                "Untracked Quantity" := "Untracked Quantity" - ReservedQty;
            END;
          END ELSE BEGIN
            "Primary Order Type" := DATABASE::"Planning Component";
            "Primary Order Status" := PlanComponent."Ref. Order Status";
            "Primary Order No." := PlanComponent."Ref. Order No.";
          END;
        PlanComponent."Ref. Order Type"::Assembly:
          IF AsmLine.GET(
               PlanComponent."Ref. Order Status",
               PlanComponent."Ref. Order No.",
               PlanComponent."Ref. Order Line No.")
          THEN BEGIN
            "Original Quantity" := AsmLine.Quantity;
            AsmLine.CALCFIELDS("Reserved Qty. (Base)");
            IF AsmLine."Reserved Qty. (Base)" > 0 THEN BEGIN
              ReservedQty := AsmLine."Reserved Qty. (Base)";
              AsmLineReserve.FilterReservFor(ReservEntry,AsmLine);
              CalcReservedQty(ReservEntry,ReservedQty);
              IF ReservedQty > "Untracked Quantity" THEN
                "Untracked Quantity" := 0
              ELSE
                "Untracked Quantity" := "Untracked Quantity" - ReservedQty;
            END;
          END ELSE BEGIN
            "Primary Order Type" := DATABASE::"Planning Component";
            "Primary Order Status" := PlanComponent."Ref. Order Status";
            "Primary Order No." := PlanComponent."Ref. Order No.";
          END;
      END;
      Quantity := PlanComponent."Expected Quantity";
      "Remaining Quantity" := PlanComponent."Expected Quantity";
      "Finished Quantity" := 0;
      "Quantity (Base)" := PlanComponent."Expected Quantity (Base)";
      "Remaining Quantity (Base)" := PlanComponent."Expected Quantity (Base)";
      "Unit of Measure Code" := PlanComponent."Unit of Measure Code";
      "Qty. per Unit of Measure" := PlanComponent."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
    END;

    LOCAL PROCEDURE CalcReservedQty@20(VAR ReservEntry@1000 : Record 337;VAR ReservedQty@1002 : Decimal);
    VAR
      OppositeReservEntry@1001 : Record 337;
    BEGIN
      ReservEntry.SETCURRENTKEY(
        "Source ID",
        "Source Ref. No.",
        "Source Type",
        "Source Subtype",
        "Source Batch Name",
        "Source Prod. Order Line",
        "Reservation Status");
      ReservEntry.SETRANGE("Reservation Status",ReservEntry."Reservation Status"::Reservation);
      ReservEntry.SETRANGE(Binding,ReservEntry.Binding::"Order-to-Order");
      IF ReservEntry.FIND('-') THEN BEGIN
        // Retrieving information about primary order:
        IF ReservEntry.Positive THEN
          OppositeReservEntry.GET(ReservEntry."Entry No.",NOT ReservEntry.Positive)
        ELSE
          OppositeReservEntry := ReservEntry;
        IF "Primary Order No." = '' THEN BEGIN
          "Primary Order Type" := OppositeReservEntry."Source Type";
          "Primary Order Status" := OppositeReservEntry."Source Subtype";
          "Primary Order No." := OppositeReservEntry."Source ID";
        END;

        Binding := ReservEntry.Binding;
        REPEAT
          ReservedQty := ReservedQty + ReservEntry."Quantity (Base)";
        UNTIL ReservEntry.NEXT = 0;
      END;
    END;

    PROCEDURE TransferFromPurchaseLine@3(VAR PurchaseLine@1000 : Record 39;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReservePurchLine@1002 : Codeunit 99000834;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      PurchaseLine.TESTFIELD(Type,PurchaseLine.Type::Item);
      "Source Type" := DATABASE::"Purchase Line";
      "Source Order Status" := PurchaseLine."Document Type";
      "Source ID" := PurchaseLine."Document No.";
      "Source Ref. No." := PurchaseLine."Line No.";
      "Item No." := PurchaseLine."No.";
      "Variant Code" := PurchaseLine."Variant Code";
      "Location Code" := PurchaseLine."Location Code";
      "Bin Code" := PurchaseLine."Bin Code";
      ReservePurchLine.FilterReservFor(ReservEntry,PurchaseLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      PurchaseLine.CALCFIELDS("Reserved Qty. (Base)");
      IF PurchaseLine."Document Type" = PurchaseLine."Document Type"::"Return Order" THEN BEGIN
        AutoReservedQty := -AutoReservedQty;
        PurchaseLine."Reserved Qty. (Base)" := -PurchaseLine."Reserved Qty. (Base)";
      END;
      "Untracked Quantity" :=
        PurchaseLine."Outstanding Qty. (Base)" -
        PurchaseLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      "Min. Quantity" :=
        PurchaseLine."Reserved Qty. (Base)" -
        AutoReservedQty;
      Quantity := PurchaseLine.Quantity;
      "Remaining Quantity" := PurchaseLine."Outstanding Quantity";
      "Finished Quantity" := PurchaseLine."Quantity Received";
      "Quantity (Base)" := PurchaseLine."Quantity (Base)";
      "Remaining Quantity (Base)" := PurchaseLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := PurchaseLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := PurchaseLine."Qty. per Unit of Measure";
      IF PurchaseLine."Document Type" = PurchaseLine."Document Type"::"Return Order" THEN BEGIN
        ChangeSign;
        "Planning Flexibility" := "Planning Flexibility"::None;
      END ELSE
        "Planning Flexibility" := PurchaseLine."Planning Flexibility";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := PurchaseLine."Expected Receipt Date";
      "Drop Shipment" := PurchaseLine."Drop Shipment";
      "Special Order" := PurchaseLine."Special Order";
    END;

    PROCEDURE TransferFromProdOrderLine@4(VAR ProdOrderLine@1000 : Record 5406;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveProdOrderLine@1002 : Codeunit 99000837;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Prod. Order Line";
      "Source Order Status" := ProdOrderLine.Status;
      "Source ID" := ProdOrderLine."Prod. Order No.";
      "Source Prod. Order Line" := ProdOrderLine."Line No.";
      "Item No." := ProdOrderLine."Item No.";
      "Variant Code" := ProdOrderLine."Variant Code";
      "Location Code" := ProdOrderLine."Location Code";
      "Bin Code" := ProdOrderLine."Bin Code";
      "Due Date" := ProdOrderLine."Due Date";
      "Starting Date" := ProdOrderLine."Starting Date";
      "Planning Flexibility" := ProdOrderLine."Planning Flexibility";
      "Planning Level Code" := ProdOrderLine."Planning Level Code";
      ProdOrderLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveProdOrderLine.FilterReservFor(ReservEntry,ProdOrderLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        ProdOrderLine."Remaining Qty. (Base)" -
        ProdOrderLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      "Min. Quantity" :=
        ProdOrderLine."Reserved Qty. (Base)" -
        AutoReservedQty;
      Quantity := ProdOrderLine.Quantity;
      "Remaining Quantity" := ProdOrderLine."Remaining Quantity";
      "Finished Quantity" := ProdOrderLine."Finished Quantity";
      "Quantity (Base)" := ProdOrderLine."Quantity (Base)";
      "Remaining Quantity (Base)" := ProdOrderLine."Remaining Qty. (Base)";
      "Unit of Measure Code" := ProdOrderLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ProdOrderLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;
    END;

    PROCEDURE TransferFromAsmLine@12(VAR AsmLine@1000 : Record 901;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AsmLineReserve@1002 : Codeunit 926;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      AsmLine.TESTFIELD(Type,AsmLine.Type::Item);
      "Source Type" := DATABASE::"Assembly Line";
      "Source Order Status" := AsmLine."Document Type";
      "Source ID" := AsmLine."Document No.";
      "Source Ref. No." := AsmLine."Line No.";
      "Ref. Order Type" := "Ref. Order Type"::Assembly;
      "Ref. Order No." := AsmLine."Document No.";
      "Ref. Line No." := AsmLine."Line No.";
      "Item No." := AsmLine."No.";
      "Variant Code" := AsmLine."Variant Code";
      "Location Code" := AsmLine."Location Code";
      "Bin Code" := AsmLine."Bin Code";
      AsmLine.CALCFIELDS("Reserved Qty. (Base)");
      AsmLineReserve.FilterReservFor(ReservEntry,AsmLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" :=
        AsmLine."Remaining Quantity (Base)" -
        AsmLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := AsmLine.Quantity;
      "Remaining Quantity" := AsmLine."Remaining Quantity";
      "Finished Quantity" := AsmLine."Consumed Quantity";
      "Quantity (Base)" := AsmLine."Quantity (Base)";
      "Remaining Quantity (Base)" := AsmLine."Remaining Quantity (Base)";
      "Unit of Measure Code" := AsmLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := AsmLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := AsmLine."Due Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
    END;

    PROCEDURE TransferFromAsmHeader@13(VAR AsmHeader@1000 : Record 900;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      AsmHeaderReserve@1002 : Codeunit 925;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Assembly Header";
      "Source Order Status" := AsmHeader."Document Type";
      "Source ID" := AsmHeader."No.";
      "Item No." := AsmHeader."Item No.";
      "Variant Code" := AsmHeader."Variant Code";
      "Location Code" := AsmHeader."Location Code";
      "Bin Code" := AsmHeader."Bin Code";
      AsmHeaderReserve.FilterReservFor(ReservEntry,AsmHeader);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingReservEntry);
      AsmHeader.CALCFIELDS("Reserved Qty. (Base)");
      "Untracked Quantity" :=
        AsmHeader."Remaining Quantity (Base)" -
        AsmHeader."Reserved Qty. (Base)" +
        AutoReservedQty;
      "Min. Quantity" :=
        AsmHeader."Reserved Qty. (Base)" -
        AutoReservedQty;
      Quantity := AsmHeader.Quantity;
      "Remaining Quantity" := AsmHeader."Remaining Quantity";
      "Finished Quantity" := AsmHeader."Assembled Quantity";
      "Quantity (Base)" := AsmHeader."Quantity (Base)";
      "Remaining Quantity (Base)" := AsmHeader."Remaining Quantity (Base)";
      "Unit of Measure Code" := AsmHeader."Unit of Measure Code";
      "Qty. per Unit of Measure" := AsmHeader."Qty. per Unit of Measure";
      "Planning Flexibility" := AsmHeader."Planning Flexibility";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := AsmHeader."Due Date";
    END;

    PROCEDURE TransferFromRequisitionLine@5(VAR RequisitionLine@1000 : Record 246;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveReqLine@1002 : Codeunit 99000833;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      RequisitionLine.TESTFIELD(Type,RequisitionLine.Type::Item);
      "Source Type" := DATABASE::"Requisition Line";
      "Source ID" := RequisitionLine."Worksheet Template Name";
      "Source Batch Name" := RequisitionLine."Journal Batch Name";
      "Source Ref. No." := RequisitionLine."Line No.";
      "Item No." := RequisitionLine."No.";
      "Variant Code" := RequisitionLine."Variant Code";
      "Location Code" := RequisitionLine."Location Code";
      "Bin Code" := RequisitionLine."Bin Code";
      RequisitionLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveReqLine.FilterReservFor(ReservEntry,RequisitionLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        RequisitionLine."Quantity (Base)" -
        RequisitionLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      "Min. Quantity" :=
        RequisitionLine."Reserved Qty. (Base)" -
        AutoReservedQty;
      Quantity := RequisitionLine.Quantity;
      "Finished Quantity" := 0;
      "Remaining Quantity" := RequisitionLine.Quantity;
      "Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Remaining Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Unit of Measure Code" := RequisitionLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := RequisitionLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;
      "Due Date" := RequisitionLine."Due Date";
      "Planning Flexibility" := RequisitionLine."Planning Flexibility";
    END;

    PROCEDURE TransferFromOutboundTransfPlan@16(VAR RequisitionLine@1000 : Record 246;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ReserveReqLine@1002 : Codeunit 99000833;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      RequisitionLine.TESTFIELD(Type,RequisitionLine.Type::Item);
      "Source Type" := DATABASE::"Requisition Line";
      "Source Order Status" := 1; // Inbound
      "Source ID" := RequisitionLine."Worksheet Template Name";
      "Source Batch Name" := RequisitionLine."Journal Batch Name";
      "Source Ref. No." := RequisitionLine."Line No.";
      "Item No." := RequisitionLine."No.";
      "Variant Code" := RequisitionLine."Variant Code";
      "Location Code" := RequisitionLine."Transfer-from Code";
      "Bin Code" := RequisitionLine."Bin Code";
      RequisitionLine.CALCFIELDS("Reserved Qty. (Base)");
      ReserveReqLine.FilterReservFor(ReservEntry,RequisitionLine);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      "Untracked Quantity" :=
        RequisitionLine."Quantity (Base)" -
        RequisitionLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      "Min. Quantity" :=
        RequisitionLine."Reserved Qty. (Base)" -
        AutoReservedQty;
      Quantity := RequisitionLine.Quantity;
      "Finished Quantity" := 0;
      "Remaining Quantity" := RequisitionLine.Quantity;
      "Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Remaining Quantity (Base)" := RequisitionLine."Quantity (Base)";
      "Unit of Measure Code" := RequisitionLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := RequisitionLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" <= 0;
      "Due Date" := RequisitionLine."Transfer Shipment Date";
    END;

    PROCEDURE TransferFromOutboundTransfer@14(VAR TransLine@1000 : Record 5741;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      DummyTempTrackingEntry@1007 : TEMPORARY Record 337;
      CrntInvProfile@1008 : Record 99000853;
      ReserveTransLine@1002 : Codeunit 99000836;
      AutoReservedQty@1003 : Decimal;
      MinQtyInbnd@1005 : Decimal;
      MinQtyOutbnd@1006 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Transfer Line";
      "Source Order Status" := 0; // Outbound
      "Source ID" := TransLine."Document No.";
      "Source Ref. No." := TransLine."Line No.";
      "Item No." := TransLine."Item No.";
      "Variant Code" := TransLine."Variant Code";
      "Location Code" := TransLine."Transfer-from Code";

      TransLine.CALCFIELDS("Reserved Qty. Outbnd. (Base)","Reserved Qty. Inbnd. (Base)");
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,0);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingEntry);
      MinQtyOutbnd := TransLine."Reserved Qty. Outbnd. (Base)" - AutoReservedQty;

      CrntInvProfile := Rec;
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,1);
      AutoReservedQty := TransferBindings(ReservEntry,DummyTempTrackingEntry);
      MinQtyInbnd := TransLine."Reserved Qty. Inbnd. (Base)" - AutoReservedQty;
      Rec := CrntInvProfile;

      IF MinQtyInbnd > MinQtyOutbnd THEN
        "Min. Quantity" := MinQtyInbnd
      ELSE
        "Min. Quantity" := MinQtyOutbnd;

      "Untracked Quantity" := TransLine."Outstanding Qty. (Base)" - MinQtyOutbnd;
      Quantity := TransLine.Quantity;
      "Remaining Quantity" := TransLine."Outstanding Quantity";
      "Finished Quantity" := TransLine."Quantity Shipped";
      "Quantity (Base)" := TransLine."Quantity (Base)";
      "Remaining Quantity (Base)" := TransLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := TransLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := TransLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := TransLine."Shipment Date";
      "Planning Flexibility" := TransLine."Planning Flexibility";
    END;

    PROCEDURE TransferFromInboundTransfer@15(VAR TransLine@1000 : Record 5741;VAR TrackingEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      DummyTempTrackingEntry@1007 : TEMPORARY Record 337;
      CrntInvProfile@1008 : Record 99000853;
      ReserveTransLine@1002 : Codeunit 99000836;
      AutoReservedQty@1003 : Decimal;
      MinQtyInbnd@1006 : Decimal;
      MinQtyOutbnd@1005 : Decimal;
    BEGIN
      "Source Type" := DATABASE::"Transfer Line";
      "Source Order Status" := 1; // Inbound
      "Source ID" := TransLine."Document No.";
      "Source Ref. No." := TransLine."Line No.";
      "Source Prod. Order Line" := TransLine."Derived From Line No.";
      "Item No." := TransLine."Item No.";
      "Variant Code" := TransLine."Variant Code";
      "Location Code" := TransLine."Transfer-to Code";

      TransLine.CALCFIELDS("Reserved Qty. Outbnd. (Base)","Reserved Qty. Inbnd. (Base)");
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,1);
      AutoReservedQty := TransferBindings(ReservEntry,TrackingEntry);
      MinQtyInbnd := TransLine."Reserved Qty. Inbnd. (Base)" - AutoReservedQty;

      CrntInvProfile := Rec;
      ReserveTransLine.FilterReservFor(ReservEntry,TransLine,0);
      AutoReservedQty := -TransferBindings(ReservEntry,DummyTempTrackingEntry);
      MinQtyOutbnd := TransLine."Reserved Qty. Outbnd. (Base)" - AutoReservedQty;
      Rec := CrntInvProfile;

      IF MinQtyInbnd > MinQtyOutbnd THEN
        "Min. Quantity" := MinQtyInbnd
      ELSE
        "Min. Quantity" := MinQtyOutbnd;

      "Untracked Quantity" := TransLine."Outstanding Qty. (Base)" - MinQtyInbnd;
      Quantity := TransLine.Quantity;
      "Remaining Quantity" := TransLine."Outstanding Quantity";
      "Finished Quantity" := TransLine."Quantity Received";
      "Quantity (Base)" := TransLine."Quantity (Base)";
      "Remaining Quantity (Base)" := TransLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := TransLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := TransLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" >= 0;
      "Starting Date" := TransLine."Shipment Date";
      "Due Date" := TransLine."Receipt Date";
      "Planning Flexibility" := TransLine."Planning Flexibility";
    END;

    PROCEDURE TransferFromServLine@17(VAR ServLine@1000 : Record 5902;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      ServLineReserve@1002 : Codeunit 99000842;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      ServLine.TESTFIELD(Type,ServLine.Type::Item);
      "Source Type" := DATABASE::"Service Line";
      "Source Order Status" := ServLine."Document Type";
      "Source ID" := ServLine."Document No.";
      "Source Ref. No." := ServLine."Line No.";
      "Item No." := ServLine."No.";
      "Variant Code" := ServLine."Variant Code";
      "Location Code" := ServLine."Location Code";
      ServLine.CALCFIELDS("Reserved Qty. (Base)");
      ServLineReserve.FilterReservFor(ReservEntry,ServLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" :=
        ServLine."Outstanding Qty. (Base)" -
        ServLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := ServLine.Quantity;
      "Remaining Quantity" := ServLine."Outstanding Quantity";
      "Finished Quantity" := ServLine."Quantity Shipped";
      "Quantity (Base)" := ServLine."Quantity (Base)";
      "Remaining Quantity (Base)" := ServLine."Outstanding Qty. (Base)";
      "Unit of Measure Code" := ServLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := ServLine."Needed by Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
    END;

    PROCEDURE TransferFromJobPlanningLine@11(VAR JobPlanningLine@1000 : Record 1003;VAR TrackingReservEntry@1004 : Record 337);
    VAR
      ReservEntry@1001 : Record 337;
      JobPlanningLineReserve@1002 : Codeunit 1032;
      AutoReservedQty@1003 : Decimal;
    BEGIN
      JobPlanningLine.TESTFIELD(Type,JobPlanningLine.Type::Item);
      "Source Type" := DATABASE::"Job Planning Line";
      "Source Order Status" := JobPlanningLine.Status;
      "Source ID" := JobPlanningLine."Job No.";
      "Source Ref. No." := JobPlanningLine."Job Contract Entry No.";
      "Item No." := JobPlanningLine."No.";
      "Variant Code" := JobPlanningLine."Variant Code";
      "Location Code" := JobPlanningLine."Location Code";
      JobPlanningLine.CALCFIELDS("Reserved Qty. (Base)");
      JobPlanningLineReserve.FilterReservFor(ReservEntry,JobPlanningLine);
      AutoReservedQty := -TransferBindings(ReservEntry,TrackingReservEntry);
      "Untracked Quantity" :=
        JobPlanningLine."Remaining Qty. (Base)" -
        JobPlanningLine."Reserved Qty. (Base)" +
        AutoReservedQty;
      Quantity := JobPlanningLine.Quantity;
      "Remaining Quantity" := JobPlanningLine."Remaining Qty.";
      "Finished Quantity" := JobPlanningLine."Qty. Posted";
      "Quantity (Base)" := JobPlanningLine."Quantity (Base)";
      "Remaining Quantity (Base)" := JobPlanningLine."Remaining Qty. (Base)";
      "Unit of Measure Code" := JobPlanningLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := JobPlanningLine."Qty. per Unit of Measure";
      IsSupply := "Untracked Quantity" < 0;
      "Due Date" := JobPlanningLine."Planning Date";
      "Planning Flexibility" := "Planning Flexibility"::None;
    END;

    LOCAL PROCEDURE TransferBindings@10(VAR ReservEntry@1000 : Record 337;VAR TrackingEntry@1004 : Record 337) : Decimal;
    VAR
      OppositeReservEntry@1001 : Record 337;
      AutoReservedQty@1002 : Decimal;
      Found@1003 : Boolean;
      InsertTracking@1005 : Boolean;
    BEGIN
      ReservEntry.SETCURRENTKEY(
        "Source ID",
        "Source Ref. No.",
        "Source Type",
        "Source Subtype",
        "Source Batch Name",
        "Source Prod. Order Line",
        "Reservation Status");

      IF ReservEntry.FINDSET THEN
        REPEAT
          InsertTracking := NOT
            ((ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation) AND
             (ReservEntry.Binding = ReservEntry.Binding::" "));
          IF InsertTracking AND ReservEntry.TrackingExists AND
             (ReservEntry."Source Type" <> DATABASE::"Item Ledger Entry")
          THEN BEGIN
            TrackingEntry := ReservEntry;
            TrackingEntry.INSERT;
          END;
          IF ReservEntry."Reservation Status" < ReservEntry."Reservation Status"::Surplus
          THEN
            IF (ReservEntry.Binding = ReservEntry.Binding::"Order-to-Order")
            THEN BEGIN
              IF ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation THEN
                AutoReservedQty := AutoReservedQty + ReservEntry."Quantity (Base)";
              IF NOT Found THEN BEGIN
                IF ReservEntry.Positive THEN
                  OppositeReservEntry.GET(ReservEntry."Entry No.",NOT ReservEntry.Positive)
                ELSE
                  OppositeReservEntry := ReservEntry;
                IF "Primary Order No." = '' THEN BEGIN
                  "Primary Order Type" := OppositeReservEntry."Source Type";
                  "Primary Order Status" := OppositeReservEntry."Source Subtype";
                  "Primary Order No." := OppositeReservEntry."Source ID";
                  IF OppositeReservEntry."Source Type" <> DATABASE::"Prod. Order Component" THEN
                    "Primary Order Line" := OppositeReservEntry."Source Ref. No.";
                END;
                Binding := ReservEntry.Binding;
                "Disallow Cancellation" := ReservEntry."Disallow Cancellation";
                Found := TRUE;
              END;
            END ELSE
              IF (ReservEntry."Reservation Status" = ReservEntry."Reservation Status"::Reservation) AND
                 (("Fixed Date" = 0D) OR ("Fixed Date" > ReservEntry."Shipment Date"))
              THEN
                "Fixed Date" := ReservEntry."Shipment Date";
        UNTIL ReservEntry.NEXT = 0;
      EXIT(AutoReservedQty);
    END;

    PROCEDURE TransferQtyFromItemTrgkEntry@18(VAR ItemTrackingEntry@1000 : Record 337);
    BEGIN
      "Original Quantity" := 0;
      Quantity := ItemTrackingEntry.Quantity;
      "Quantity (Base)" := ItemTrackingEntry."Quantity (Base)";
      "Finished Quantity" := 0;
      "Min. Quantity" := 0;
      "Remaining Quantity" := ItemTrackingEntry.Quantity;
      "Remaining Quantity (Base)" := ItemTrackingEntry."Quantity (Base)";
      "Untracked Quantity" := ItemTrackingEntry."Quantity (Base)";
      IF NOT IsSupply THEN
        ChangeSign;
    END;

    PROCEDURE ReduceQtyByItemTracking@19(VAR NewInvProfile@1000 : Record 99000853);
    BEGIN
      "Original Quantity" -= NewInvProfile."Original Quantity";
      Quantity -= NewInvProfile.Quantity;
      "Quantity (Base)" -= NewInvProfile."Quantity (Base)";
      "Finished Quantity" -= NewInvProfile."Finished Quantity";
      "Remaining Quantity" -= NewInvProfile."Remaining Quantity";
      "Remaining Quantity (Base)" -= NewInvProfile."Remaining Quantity (Base)";
      "Untracked Quantity" -= NewInvProfile."Untracked Quantity";
    END;

    PROCEDURE ChangeSign@6();
    BEGIN
      "Original Quantity" := -"Original Quantity";
      "Remaining Quantity (Base)" := -"Remaining Quantity (Base)";
      "Untracked Quantity" := -"Untracked Quantity";
      "Quantity (Base)" := -"Quantity (Base)";
      Quantity := -Quantity;
      "Remaining Quantity" := -"Remaining Quantity";
      "Finished Quantity" := -"Finished Quantity";
    END;

    PROCEDURE TransferToTrackingEntry@9(VAR TrkgReservEntry@1000 : Record 337;UseSecondaryFields@1001 : Boolean);
    VAR
      ReqLine@1002 : Record 246;
    BEGIN
      CASE "Source Type" OF
        0:
          BEGIN
            // Surplus, Reorder Point
            TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
            TrkgReservEntry."Suppressed Action Msg." := TRUE;
            EXIT;
          END;
        DATABASE::"Production Forecast Entry":
          BEGIN
            // Will be marked as Surplus
            TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
            TrkgReservEntry."Source Type" := DATABASE::"Production Forecast Entry";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Suppressed Action Msg." := TRUE;
          END;
        DATABASE::"Sales Line":
          BEGIN
            IF "Source Order Status" = 4 THEN BEGIN
              // Blanket Order will be marked as Surplus
              TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
              TrkgReservEntry."Suppressed Action Msg." := TRUE;
            END;
            TrkgReservEntry."Source Type" := DATABASE::"Sales Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Requisition Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Requisition Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status"; // To handle transfers
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Batch Name" := "Source Batch Name";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Purchase Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Purchase Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Item Ledger Entry":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Item Ledger Entry";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Prod. Order Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Prod. Order Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Prod. Order Line" := "Source Prod. Order Line";
          END;
        DATABASE::"Prod. Order Component":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Prod. Order Component";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Prod. Order Line" := "Source Prod. Order Line";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Planning Component":
          IF UseSecondaryFields THEN BEGIN
            ReqLine.GET("Source ID","Source Batch Name","Source Prod. Order Line");
            CASE ReqLine."Ref. Order Type" OF
              ReqLine."Ref. Order Type"::"Prod. Order":
                TrkgReservEntry."Source Type" := DATABASE::"Prod. Order Component";
              ReqLine."Ref. Order Type"::Assembly:
                TrkgReservEntry."Source Type" := DATABASE::"Assembly Line";
            END;
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Ref. Order No.";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
            TrkgReservEntry."Source Prod. Order Line" := "Ref. Line No.";
          END ELSE BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Planning Component";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Batch Name" := "Source Batch Name";
            TrkgReservEntry."Source Prod. Order Line" := "Source Prod. Order Line";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
            TrkgReservEntry."Source Subtype" := 0;
          END;
        DATABASE::"Assembly Line":
          BEGIN
            IF "Source Order Status" = 4 THEN BEGIN
              // Blanket Order will be marked as Surplus
              TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Surplus;
              TrkgReservEntry."Suppressed Action Msg." := TRUE;
            END;
            TrkgReservEntry."Source Type" := DATABASE::"Assembly Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Assembly Header":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Assembly Header";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Transfer Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Transfer Line";
            IF IsSupply THEN BEGIN
              TrkgReservEntry."Source Subtype" := 1; // Supply => Direction := Inbound
              TrkgReservEntry."Source Prod. Order Line" := "Source Prod. Order Line";
            END ELSE
              TrkgReservEntry."Source Subtype" := 0; // Demand => Direction := Outbound
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Service Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Service Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        DATABASE::"Job Planning Line":
          BEGIN
            TrkgReservEntry."Source Type" := DATABASE::"Job Planning Line";
            TrkgReservEntry."Source Subtype" := "Source Order Status";
            TrkgReservEntry."Source ID" := "Source ID";
            TrkgReservEntry."Source Ref. No." := "Source Ref. No.";
          END;
        ELSE
          ERROR(Text000,"Source Type");
      END;

      TrkgReservEntry."Item No." := "Item No.";
      TrkgReservEntry."Location Code" := "Location Code";
      TrkgReservEntry.Description := '';
      TrkgReservEntry."Creation Date" := TODAY;
      TrkgReservEntry."Created By" := USERID;
      TrkgReservEntry."Qty. per Unit of Measure" := "Qty. per Unit of Measure";
      TrkgReservEntry."Variant Code" := "Variant Code";
      TrkgReservEntry.Binding := Binding;
      TrkgReservEntry."Disallow Cancellation" := "Disallow Cancellation";
      TrkgReservEntry."Lot No." := "Lot No.";
      TrkgReservEntry."Serial No." := "Serial No.";
      TrkgReservEntry."Expiration Date" := "Expiration Date";

      IF IsSupply THEN
        TrkgReservEntry."Quantity (Base)" := "Untracked Quantity"
      ELSE
        TrkgReservEntry."Quantity (Base)" := -"Untracked Quantity";

      TrkgReservEntry.Quantity :=
        ROUND(TrkgReservEntry."Quantity (Base)" / TrkgReservEntry."Qty. per Unit of Measure",0.00001);
      TrkgReservEntry.Positive := TrkgReservEntry."Quantity (Base)" > 0;

      IF TrkgReservEntry."Reservation Status" <> TrkgReservEntry."Reservation Status"::Surplus THEN
        IF ("Planning Level Code" > 0) OR
           (Binding = Binding::"Order-to-Order")
        THEN
          TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Reservation
        ELSE
          TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Tracking;

      IF TrkgReservEntry."Quantity (Base)" = 0 THEN BEGIN
        TrkgReservEntry."Expected Receipt Date" := GetExpectedReceiptDate;
        TrkgReservEntry."Shipment Date" := "Due Date";
      END ELSE
        IF TrkgReservEntry.Positive THEN
          TrkgReservEntry."Expected Receipt Date" := GetExpectedReceiptDate
        ELSE
          TrkgReservEntry."Shipment Date" := "Due Date";
    END;

    PROCEDURE ActiveInWarehouse@23() : Boolean;
    VAR
      WhseValidateSourceLine@1000 : Codeunit 5777;
    BEGIN
      IF "Source Type" = DATABASE::"Transfer Line" THEN
        EXIT(WhseValidateSourceLine.WhseLinesExist("Source Type",0,"Source ID","Source Ref. No.",0,Quantity));

      EXIT(WhseValidateSourceLine.WhseLinesExist("Source Type","Source Order Status","Source ID","Source Ref. No.",0,Quantity));
    END;

    LOCAL PROCEDURE GetExpectedReceiptDate@22() : Date;
    BEGIN
      IF "Action Message" IN ["Action Message"::Reschedule,"Action Message"::"Resched.& Chg. Qty."] THEN
        EXIT("Original Due Date");
      EXIT("Due Date");
    END;

    PROCEDURE TrackingExists@21() : Boolean;
    BEGIN
      EXIT(("Lot No." <> '') OR ("Serial No." <> ''));
    END;

    BEGIN
    END.
  }
}

