OBJECT Table 246 Requisition Line
{
  OBJECT-PROPERTIES
  {
    Date=12/22/15;
    Time=12:00:00 PM;
    Version List=NAVW19.00.00.44365;
  }
  PROPERTIES
  {
    DataCaptionFields=Journal Batch Name,Line No.;
    OnInsert=VAR
               Rec2@1000 : Record 246;
             BEGIN
               IF CURRENTKEY <> Rec2.CURRENTKEY THEN BEGIN
                 Rec2 := Rec;
                 Rec2.SETRECFILTER;
                 Rec2.SETRANGE("Line No.");
                 IF Rec2.FINDLAST THEN
                   "Line No." := Rec2."Line No." + 10000;
               END;

               ReserveReqLine.VerifyQuantity(Rec,xRec);

               ReqWkshTmpl.GET("Worksheet Template Name");
               ReqWkshName.GET("Worksheet Template Name","Journal Batch Name");

               ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
               ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
             END;

    OnModify=BEGIN
               ReserveReqLine.VerifyChange(Rec,xRec);
             END;

    OnDelete=BEGIN
               ReqLine.RESET;
               ReqLine.GET("Worksheet Template Name","Journal Batch Name","Line No.");
               WHILE (ReqLine.NEXT <> 0) AND (ReqLine.Level > Level) DO
                 ReqLine.DELETE(TRUE);

               ReserveReqLine.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);

               DeleteRelations;
             END;

    OnRename=BEGIN
               ERROR(Text004,TABLECAPTION);
             END;

    CaptionML=[ENU=Requisition Line;
               ESM=L¡n. hoja demanda;
               FRC=Ligne de r‚quisition;
               ENC=Requisition Line];
    LookupPageID=Page517;
    DrillDownPageID=Page517;
  }
  FIELDS
  {
    { 1   ;   ;Worksheet Template Name;Code10     ;TableRelation="Req. Wksh. Template";
                                                   CaptionML=[ENU=Worksheet Template Name;
                                                              ESM=Nombre libro hoja dem.;
                                                              FRC=Nom modŠle feuille de travail;
                                                              ENC=Worksheet Template Name] }
    { 2   ;   ;Journal Batch Name  ;Code10        ;TableRelation="Requisition Wksh. Name".Name WHERE (Worksheet Template Name=FIELD(Worksheet Template Name));
                                                   CaptionML=[ENU=Journal Batch Name;
                                                              ESM=Nombre secci¢n diario;
                                                              FRC=Nom lot de journal;
                                                              ENC=Journal Batch Name] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              ESM=N§ l¡nea;
                                                              FRC=Nø ligne;
                                                              ENC=Line No.] }
    { 4   ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF Type <> xRec.Type THEN BEGIN
                                                                  TempReqLine := Rec;

                                                                  DeleteRelations;
                                                                  "Dimension Set ID" := 0;
                                                                  "No." := '';
                                                                  "Variant Code" := '';
                                                                  "Location Code" := '';
                                                                  "Prod. Order No." := '';
                                                                  ReserveReqLine.VerifyChange(Rec,xRec);
                                                                  AddOnIntegrMgt.ResetReqLineFields(Rec);
                                                                  INIT;
                                                                  Type := TempReqLine.Type;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              ESM=Tipo;
                                                              FRC=Type;
                                                              ENC=Type];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item";
                                                                    ESM=" ,Cuenta,Producto";
                                                                    FRC=" ,Compte (GL),Article";
                                                                    ENC=" ,G/L Account,Item"];
                                                   OptionString=[ ,G/L Account,Item] }
    { 5   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Type=CONST(Item)) Item WHERE (Type=CONST(Inventory));
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                ReserveReqLine.VerifyChange(Rec,xRec);
                                                                DeleteRelations;

                                                                IF "No." = '' THEN BEGIN
                                                                  CreateDim(
                                                                    DimMgt.TypeToTableID3(Type),
                                                                    "No.",DATABASE::Vendor,"Vendor No.");
                                                                  INIT;
                                                                  Type := xRec.Type;
                                                                  EXIT;
                                                                END;

                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  "Prod. Order No." := '';
                                                                  AddOnIntegrMgt.ResetReqLineFields(Rec);
                                                                END;

                                                                TESTFIELD(Type);
                                                                CASE Type OF
                                                                  Type::"G/L Account":
                                                                    BEGIN
                                                                      GLAcc.GET("No.");
                                                                      GLAcc.CheckGLAcc;
                                                                      GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      Description := GLAcc.Name;
                                                                    END;
                                                                  Type::Item:
                                                                    BEGIN
                                                                      GetItem;
                                                                      IF PlanningResiliency AND Item.Blocked THEN
                                                                        TempPlanningErrorLog.SetError(
                                                                          STRSUBSTNO(Text031,Item.TABLECAPTION,Item."No."),
                                                                          DATABASE::Item,Item.GETPOSITION);
                                                                      Item.TESTFIELD(Blocked,FALSE);
                                                                      UpdateDescription;
                                                                      "Low-Level Code" := Item."Low-Level Code";
                                                                      "Scrap %" := Item."Scrap %";
                                                                      "Item Category Code" := Item."Item Category Code";
                                                                      "Gen. Prod. Posting Group" := Item."Gen. Prod. Posting Group";
                                                                      "Gen. Business Posting Group" := '';
                                                                      IF PlanningResiliency AND (Item."Base Unit of Measure" = '') THEN
                                                                        TempPlanningErrorLog.SetError(
                                                                          STRSUBSTNO(Text032,Item.TABLECAPTION,Item."No.",
                                                                            Item.FIELDCAPTION("Base Unit of Measure")),
                                                                          DATABASE::Item,Item.GETPOSITION);
                                                                      Item.TESTFIELD("Base Unit of Measure");
                                                                      "Indirect Cost %" := Item."Indirect Cost %";
                                                                      GetPlanningParameters.AtSKU(SKU,"No.","Variant Code","Location Code");
                                                                      IF Subcontracting THEN
                                                                        SKU."Replenishment System" := SKU."Replenishment System"::"Prod. Order";
                                                                      VALIDATE("Replenishment System",SKU."Replenishment System");
                                                                      "Accept Action Message" := TRUE;
                                                                      "Product Group Code" := Item."Product Group Code";
                                                                      GetDirectCost(FIELDNO("No."));
                                                                      IF ("Location Code" <> '') AND ("No." <> '') THEN BEGIN
                                                                        IF ("Bin Code" = '') AND ("Ref. Order Type" = "Ref. Order Type"::"Prod. Order") THEN
                                                                          "Bin Code" := WMSManagement.GetLastOperationFromBinCode("Routing No.","Routing Version Code","Location Code",FALSE,0);
                                                                        GetLocation("Location Code");
                                                                        IF ("Bin Code" = '') AND ("Ref. Order Type" = "Ref. Order Type"::"Prod. Order") THEN
                                                                          "Bin Code" := Location.GetBinCode(FALSE,0);
                                                                        IF ("Bin Code" = '') AND Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                          WMSManagement.GetDefaultBin("No.","Variant Code","Location Code","Bin Code")
                                                                      END;
                                                                    END;
                                                                END;

                                                                IF "Planning Line Origin" <> "Planning Line Origin"::"Order Planning" THEN
                                                                  IF ("Replenishment System" = "Replenishment System"::Purchase) AND
                                                                     (Item."Purch. Unit of Measure" <> '')
                                                                  THEN
                                                                    VALIDATE("Unit of Measure Code",Item."Purch. Unit of Measure")
                                                                  ELSE
                                                                    VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");

                                                                CreateDim(
                                                                  DimMgt.TypeToTableID3(Type),
                                                                  "No.",DATABASE::Vendor,"Vendor No.");
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              ESM=N§;
                                                              FRC=Nø;
                                                              ENC=No.] }
    { 6   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              ESM=Descripci¢n;
                                                              FRC=Description;
                                                              ENC=Description] }
    { 7   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              ESM=Descripci¢n 2;
                                                              FRC=Description 2;
                                                              ENC=Description 2] }
    { 8   ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                "Quantity (Base)" := CalcBaseQty(Quantity);
                                                                IF Type = Type::Item THEN BEGIN
                                                                  GetDirectCost(FIELDNO(Quantity));
                                                                  "Remaining Quantity" := Quantity - "Finished Quantity";
                                                                  "Remaining Qty. (Base)" := "Remaining Quantity" * "Qty. per Unit of Measure";

                                                                  IF (CurrFieldNo = FIELDNO(Quantity)) OR (CurrentFieldNo = FIELDNO(Quantity)) THEN
                                                                    SetActionMessage;

                                                                  "Net Quantity (Base)" := (Quantity - "Original Quantity") * "Qty. per Unit of Measure";

                                                                  VALIDATE("Unit Cost");
                                                                  IF ValidateFields THEN
                                                                    IF "Ending Date" <> 0D THEN
                                                                      VALIDATE("Ending Time")
                                                                    ELSE BEGIN
                                                                      IF "Starting Date" = 0D THEN
                                                                        "Starting Date" := WORKDATE;
                                                                      VALIDATE("Starting Time");
                                                                    END;
                                                                  ReserveReqLine.VerifyQuantity(Rec,xRec);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              ESM=Cantidad;
                                                              FRC=Quantit‚;
                                                              ENC=Quantity];
                                                   DecimalPlaces=0:5 }
    { 9   ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                IF "Vendor No." <> '' THEN
                                                                  IF Vend.GET("Vendor No.") THEN BEGIN
                                                                    IF Vend.Blocked = Vend.Blocked::All THEN BEGIN
                                                                      IF PlanningResiliency THEN
                                                                        TempPlanningErrorLog.SetError(
                                                                          STRSUBSTNO(Text031,Vend.TABLECAPTION,Vend."No."),
                                                                          DATABASE::Vendor,Vend.GETPOSITION);
                                                                      Vend.VendBlockedErrorMessage(Vend,FALSE);
                                                                    END;
                                                                    IF "Order Date" = 0D THEN
                                                                      VALIDATE("Order Date",WORKDATE);

                                                                    VALIDATE("Currency Code",Vend."Currency Code");
                                                                    IF Type = Type::Item THEN
                                                                      UpdateDescription;
                                                                    VALIDATE(Quantity);
                                                                  END ELSE BEGIN
                                                                    IF ValidateFields THEN
                                                                      ERROR(Text005,FIELDCAPTION("Vendor No."),"Vendor No.");
                                                                    "Vendor No." := '';
                                                                  END
                                                                ELSE
                                                                  UpdateDescription;

                                                                "Order Address Code" := '';

                                                                IF (Type = Type::Item) AND ("No." <> '') AND ("Prod. Order No." = '') THEN BEGIN
                                                                  IF ItemVend.GET("Vendor No.","No.","Variant Code") THEN BEGIN
                                                                    "Vendor Item No." := ItemVend."Vendor Item No.";
                                                                    UpdateOrderReceiptDate(ItemVend."Lead Time Calculation");
                                                                  END ELSE BEGIN
                                                                    IF "Vendor No." = Item."Vendor No." THEN
                                                                      "Vendor Item No." := Item."Vendor Item No."
                                                                    ELSE
                                                                      "Vendor Item No." := '';
                                                                  END;
                                                                  GetDirectCost(FIELDNO("Vendor No."))
                                                                END;
                                                                "Supply From" := "Vendor No.";

                                                                CreateDim(
                                                                  DATABASE::Vendor,"Vendor No.",
                                                                  DimMgt.TypeToTableID3(Type),"No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF LookupVendor(Vend) THEN
                                                                VALIDATE("Vendor No.",Vend."No.");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Vendor No.;
                                                              ESM=N§ proveedor;
                                                              FRC=Nø fournisseur;
                                                              ENC=Vendor No.] }
    { 10  ;   ;Direct Unit Cost    ;Decimal       ;CaptionML=[ENU=Direct Unit Cost;
                                                              ESM=Costo unit. directo;
                                                              FRC=Co–t unitaire direct;
                                                              ENC=Direct Unit Cost];
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code" }
    { 12  ;   ;Due Date            ;Date          ;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Due Date")) OR (CurrentFieldNo = FIELDNO("Due Date")) THEN
                                                                  SetActionMessage;

                                                                IF "Due Date" = 0D THEN
                                                                  EXIT;

                                                                IF (CurrFieldNo = FIELDNO("Due Date")) OR (CurrentFieldNo = FIELDNO("Due Date")) THEN
                                                                  IF (Type = Type::Item) AND
                                                                     ("Planning Level" = 0)
                                                                  THEN
                                                                    VALIDATE(
                                                                      "Ending Date",
                                                                      LeadTimeMgt.PlannedEndingDate("No.","Location Code","Variant Code","Due Date",'',"Ref. Order Type"))
                                                                  ELSE
                                                                    VALIDATE("Ending Date","Due Date");

                                                                CheckDueDateToDemandDate;
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              ESM=Fecha vencimiento;
                                                              FRC=Date d'‚ch‚ance;
                                                              ENC=Due Date] }
    { 13  ;   ;Requester ID        ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=VAR
                                                                UserMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                UserMgt.ValidateUserID("Requester ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("Requester ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Requester ID;
                                                              ESM=Id. solicitante;
                                                              FRC=Code demandeur;
                                                              ENC=Requester ID] }
    { 14  ;   ;Confirmed           ;Boolean       ;CaptionML=[ENU=Confirmed;
                                                              ESM=Confirmado;
                                                              FRC=Confirm‚;
                                                              ENC=Confirmed] }
    { 15  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              ESM=C¢d. dim. acceso dir. 1;
                                                              FRC=Code raccourci de dimension 1;
                                                              ENC=Shortcut Dimension 1 Code];
                                                   CaptionClass='1,2,1' }
    { 16  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   CaptionClass='1,2,2' }
    { 17  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                ValidateLocationChange;
                                                                CheckActionMessageNew;
                                                                "Bin Code" := '';
                                                                ReserveReqLine.VerifyChange(Rec,xRec);

                                                                IF Type = Type::Item THEN BEGIN
                                                                  GetPlanningParameters.AtSKU(SKU,"No.","Variant Code","Location Code");
                                                                  IF Subcontracting THEN
                                                                    SKU."Replenishment System" := SKU."Replenishment System"::"Prod. Order";
                                                                  VALIDATE("Replenishment System",SKU."Replenishment System");
                                                                  IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                    IF ("Location Code" <> '') AND ("No." <> '') THEN BEGIN
                                                                      GetLocation("Location Code");
                                                                      IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                        WMSManagement.GetDefaultBin("No.","Variant Code","Location Code","Bin Code");
                                                                    END;
                                                                    IF "Location Code" = '' THEN
                                                                      UpdateDescription;
                                                                  END;
                                                                  IF ItemVend.GET("Vendor No.","No.","Variant Code") THEN
                                                                    "Vendor Item No." := ItemVend."Vendor Item No.";
                                                                END;
                                                                GetDirectCost(FIELDNO("Location Code"));
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              ESM=C¢d. almac‚n;
                                                              FRC=Code d'emplacement;
                                                              ENC=Location Code] }
    { 18  ;   ;Recurring Method    ;Option        ;CaptionML=[ENU=Recurring Method;
                                                              ESM=Periodicidad;
                                                              FRC=M‚thode r‚currente;
                                                              ENC=Recurring Method];
                                                   OptionCaptionML=[ENU=,Fixed,Variable;
                                                                    ESM=,Fija,Variable;
                                                                    FRC=,Fixe,Variable;
                                                                    ENC=,Fixed,Variable];
                                                   OptionString=,Fixed,Variable;
                                                   BlankZero=Yes }
    { 19  ;   ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              ESM=Fecha caducidad;
                                                              FRC=Date d'expiration;
                                                              ENC=Expiration Date] }
    { 20  ;   ;Recurring Frequency ;DateFormula   ;CaptionML=[ENU=Recurring Frequency;
                                                              ESM=Frecuencia repetici¢n;
                                                              FRC=Fr‚quence de r‚currence;
                                                              ENC=Recurring Frequency] }
    { 21  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                "Starting Date" := "Order Date";

                                                                GetDirectCost(FIELDNO("Order Date"));

                                                                IF CurrFieldNo = FIELDNO("Order Date") THEN
                                                                  VALIDATE("Starting Date");
                                                              END;

                                                   CaptionML=[ENU=Order Date;
                                                              ESM=Fecha pedido;
                                                              FRC=Date commande;
                                                              ENC=Order Date] }
    { 22  ;   ;Vendor Item No.     ;Text20        ;CaptionML=[ENU=Vendor Item No.;
                                                              ESM=C¢d. producto proveedor;
                                                              FRC=Nø article fournisseur;
                                                              ENC=Vendor Item No.] }
    { 23  ;   ;Sales Order No.     ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                ReserveReqLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Sales Order No.;
                                                              ESM=N§ pedido venta;
                                                              FRC=Nø document de vente;
                                                              ENC=Sales Order No.];
                                                   Editable=No }
    { 24  ;   ;Sales Order Line No.;Integer       ;OnValidate=BEGIN
                                                                ReserveReqLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Sales Order Line No.;
                                                              ESM=N§ l¡nea pedido venta;
                                                              FRC=Nø ligne document de vente;
                                                              ENC=Sales Order Line No.];
                                                   Editable=No }
    { 25  ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF "Sell-to Customer No." = '' THEN
                                                                  "Ship-to Code" := ''
                                                                ELSE
                                                                  VALIDATE("Ship-to Code",'');

                                                                ReserveReqLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              ESM=Venta a-N§ cliente;
                                                              FRC=Nø client (d‚biteur);
                                                              ENC=Sell-to Customer No.];
                                                   Editable=No }
    { 26  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Ship-to Code" <> '' THEN BEGIN
                                                                  ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                  "Location Code" := ShipToAddr."Location Code";
                                                                END ELSE BEGIN
                                                                  Cust.GET("Sell-to Customer No.");
                                                                  "Location Code" := Cust."Location Code";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              ESM=C¢d. direcci¢n env¡o cliente;
                                                              FRC=Code de livraison;
                                                              ENC=Ship-to Code];
                                                   Editable=No }
    { 28  ;   ;Order Address Code  ;Code10        ;TableRelation="Order Address".Code WHERE (Vendor No.=FIELD(Vendor No.));
                                                   CaptionML=[ENU=Order Address Code;
                                                              ESM=C¢d. direcci¢n pedido proveed.;
                                                              FRC=Code adresse commande;
                                                              ENC=Order Address Code] }
    { 29  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                GetCurrency;
                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  TESTFIELD("Order Date");
                                                                  IF PlanningResiliency THEN
                                                                    CheckExchRate;
                                                                  VALIDATE(
                                                                    "Currency Factor",CurrExchRate.ExchangeRate(
                                                                      "Order Date","Currency Code"));
                                                                END ELSE
                                                                  VALIDATE("Currency Factor",0);
                                                                GetDirectCost(FIELDNO("Currency Code"));
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              ESM=C¢d. divisa;
                                                              FRC=Code devise;
                                                              ENC=Currency Code] }
    { 30  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Code" <> '' THEN
                                                                  TESTFIELD("Currency Factor");
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN BEGIN
                                                                  IF xRec."Currency Factor" <> 0 THEN
                                                                    "Direct Unit Cost" :=
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        "Order Date",xRec."Currency Code","Direct Unit Cost",xRec."Currency Factor");
                                                                  IF "Currency Factor" <> 0 THEN
                                                                    "Direct Unit Cost" :=
                                                                      CurrExchRate.ExchangeAmtLCYToFCY(
                                                                        "Order Date","Currency Code","Direct Unit Cost","Currency Factor");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              ESM=Factor divisa;
                                                              FRC=Facteur devise;
                                                              ENC=Currency Factor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 31  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Worksheet Template Name),
                                                                                                       Source Ref. No.=FIELD(Line No.),
                                                                                                       Source Type=CONST(246),
                                                                                                       Source Subtype=CONST(0),
                                                                                                       Source Batch Name=FIELD(Journal Batch Name),
                                                                                                       Source Prod. Order Line=CONST(0),
                                                                                                       Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              ESM=Cantidad reservada;
                                                              FRC=Quantit‚ r‚serv‚e;
                                                              ENC=Reserved Quantity];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              ESM=Id. grupo dimensiones;
                                                              FRC=Code ensemble de dimensions;
                                                              ENC=Dimension Set ID];
                                                   Editable=No }
    { 5401;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=CONST(Released));
                                                   OnValidate=BEGIN
                                                                AddOnIntegrMgt.ValidateProdOrderOnReqLine(Rec);
                                                                VALIDATE("Unit of Measure Code");
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              ESM=N§ orden producci¢n;
                                                              FRC=Nø bon de prod.;
                                                              ENC=Prod. Order No.];
                                                   Editable=No }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   OnValidate=BEGIN
                                                                IF "Variant Code" <> '' THEN
                                                                  TESTFIELD(Type,Type::Item);
                                                                CheckActionMessageNew;
                                                                ReserveReqLine.VerifyChange(Rec,xRec);

                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);

                                                                GetDirectCost(FIELDNO("Variant Code"));
                                                                IF "Variant Code" <> '' THEN BEGIN
                                                                  UpdateDescription;
                                                                  GetPlanningParameters.AtSKU(SKU,"No.","Variant Code","Location Code");
                                                                  IF Subcontracting THEN
                                                                    SKU."Replenishment System" := SKU."Replenishment System"::"Prod. Order";
                                                                  VALIDATE("Replenishment System",SKU."Replenishment System");
                                                                  IF "Variant Code" <> xRec."Variant Code" THEN BEGIN
                                                                    "Bin Code" := '';
                                                                    IF ("Location Code" <> '') AND ("No." <> '') THEN BEGIN
                                                                      GetLocation("Location Code");
                                                                      IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                        WMSManagement.GetDefaultBin("No.","Variant Code","Location Code","Bin Code")
                                                                    END;
                                                                  END;
                                                                  IF ItemVend.GET("Vendor No.","No.","Variant Code") THEN
                                                                    "Vendor Item No." := ItemVend."Vendor Item No.";
                                                                END ELSE
                                                                  VALIDATE("No.");
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              ESM=C¢d. variante;
                                                              FRC=Code variante;
                                                              ENC=Variant Code] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                 Item Filter=FIELD(No.),
                                                                                 Variant Filter=FIELD(Variant Code));
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                IF (CurrFieldNo = FIELDNO("Bin Code")) AND
                                                                   ("Action Message" <> "Action Message"::" ")
                                                                THEN
                                                                  TESTFIELD("Action Message","Action Message"::New);
                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("Location Code");
                                                                IF ("Bin Code" <> xRec."Bin Code") AND ("Bin Code" <> '') THEN BEGIN
                                                                  GetLocation("Location Code");
                                                                  Location.TESTFIELD("Bin Mandatory");
                                                                  Location.TESTFIELD("Directed Put-away and Pick",FALSE);
                                                                  GetBin("Location Code","Bin Code");
                                                                  TESTFIELD("Location Code",Bin."Location Code");
                                                                END;
                                                                ReserveReqLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Bin Code;
                                                              ESM=C¢d. ubicaci¢n;
                                                              FRC=Code de zone;
                                                              ENC=Bin Code] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;InitValue=1;
                                                   CaptionML=[ENU=Qty. per Unit of Measure;
                                                              ESM=Cdad. por unidad medida;
                                                              FRC=Quantit‚ par unit‚ de mesure;
                                                              ENC=Qty. per Unit of Measure];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5407;   ;Unit of Measure Code;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                IF (Type = Type::Item) AND
                                                                   ("No." <> '') AND
                                                                   ("Prod. Order No." = '')
                                                                THEN BEGIN
                                                                  GetItem;
                                                                  "Unit Cost" := Item."Unit Cost";
                                                                  "Overhead Rate" := Item."Overhead Rate";
                                                                  "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
                                                                  IF "Unit of Measure Code" <> '' THEN BEGIN
                                                                    "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
                                                                    "Unit Cost" := ROUND(Item."Unit Cost" * "Qty. per Unit of Measure",0.00001);
                                                                    "Overhead Rate" := ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",0.00001);
                                                                  END ELSE
                                                                    "Qty. per Unit of Measure" := 1;
                                                                END ELSE
                                                                  IF "Prod. Order No." = '' THEN
                                                                    "Qty. per Unit of Measure" := 1
                                                                  ELSE
                                                                    "Qty. per Unit of Measure" := 0;
                                                                GetDirectCost(FIELDNO("Unit of Measure Code"));

                                                                IF "Planning Line Origin" = "Planning Line Origin"::"Order Planning" THEN
                                                                  SetSupplyQty("Demand Quantity (Base)","Needed Quantity (Base)")
                                                                ELSE
                                                                  VALIDATE(Quantity);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              ESM=C¢d. unidad medida;
                                                              FRC=Code unit‚ de mesure;
                                                              ENC=Unit of Measure Code] }
    { 5408;   ;Quantity (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Prod. Order No.",'');
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE(Quantity,"Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Quantity (Base);
                                                              ESM=Cantidad (base);
                                                              FRC=Quantit‚ (base);
                                                              ENC=Quantity (Base)];
                                                   DecimalPlaces=0:5 }
    { 5431;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Worksheet Template Name),
                                                                                                                Source Ref. No.=FIELD(Line No.),
                                                                                                                Source Type=CONST(246),
                                                                                                                Source Subtype=CONST(0),
                                                                                                                Source Batch Name=FIELD(Journal Batch Name),
                                                                                                                Source Prod. Order Line=CONST(0),
                                                                                                                Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              ESM=Cdad. reservada (base);
                                                              FRC=Quantit‚ r‚serv‚e (base);
                                                              ENC=Reserved Qty. (Base)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5520;   ;Demand Type         ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Table));
                                                   CaptionML=[ENU=Demand Type;
                                                              ESM=Tipo de demanda;
                                                              FRC=Type de demande;
                                                              ENC=Demand Type];
                                                   Editable=No }
    { 5521;   ;Demand Subtype      ;Option        ;CaptionML=[ENU=Demand Subtype;
                                                              ESM=Subtipo de demanda;
                                                              FRC=Sous-type de demande;
                                                              ENC=Demand Subtype];
                                                   OptionCaptionML=[ENU=0,1,2,3,4,5,6,7,8,9;
                                                                    ESM=0,1,2,3,4,5,6,7,8,9;
                                                                    FRC=0,1,2,3,4,5,6,7,8,9;
                                                                    ENC=0,1,2,3,4,5,6,7,8,9];
                                                   OptionString=0,1,2,3,4,5,6,7,8,9;
                                                   Editable=No }
    { 5522;   ;Demand Order No.    ;Code20        ;CaptionML=[ENU=Demand Order No.;
                                                              ESM=N§ orden demanda;
                                                              FRC=Nø demande;
                                                              ENC=Demand Order No.];
                                                   Editable=No }
    { 5525;   ;Demand Line No.     ;Integer       ;CaptionML=[ENU=Demand Line No.;
                                                              ESM=N§ de l¡nea de demanda;
                                                              FRC=Nø de ligne de demande;
                                                              ENC=Demand Line No.];
                                                   Editable=No }
    { 5526;   ;Demand Ref. No.     ;Integer       ;CaptionML=[ENU=Demand Ref. No.;
                                                              ESM=N§ referencia demanda;
                                                              FRC=Nø r‚f‚rence de demande;
                                                              ENC=Demand Ref. No.];
                                                   Editable=No }
    { 5527;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              ESM=Estado;
                                                              FRC=tat;
                                                              ENC=Status];
                                                   OptionCaptionML=[ENU=0,1,2,3,4,5,6,7,8,9,10;
                                                                    ESM=0,1,2,3,4,5,6,7,8,9,10;
                                                                    FRC=0,1,2,3,4,5,6,7,8,9,10;
                                                                    ENC=0,1,2,3,4,5,6,7,8,9,10];
                                                   OptionString=0,1,2,3,4,5,6,7,8,9,10;
                                                   Editable=No }
    { 5530;   ;Demand Date         ;Date          ;CaptionML=[ENU=Demand Date;
                                                              ESM=Fecha demanda;
                                                              FRC=Date de r‚quisition;
                                                              ENC=Demand Date];
                                                   Editable=No }
    { 5532;   ;Demand Quantity     ;Decimal       ;CaptionML=[ENU=Demand Quantity;
                                                              ESM=Cdad. demanda;
                                                              FRC=Quantit‚ de la demande;
                                                              ENC=Demand Quantity];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5533;   ;Demand Quantity (Base);Decimal     ;CaptionML=[ENU=Demand Quantity (Base);
                                                              ESM=Cdad. demanda (base);
                                                              FRC=Quantit‚ de demande (base);
                                                              ENC=Demand Quantity (Base)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5538;   ;Needed Quantity     ;Decimal       ;CaptionML=[ENU=Needed Quantity;
                                                              ESM=Cantidad necesaria;
                                                              FRC=Quantit‚ requise;
                                                              ENC=Needed Quantity];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 5539;   ;Needed Quantity (Base);Decimal     ;CaptionML=[ENU=Needed Quantity (Base);
                                                              ESM=Cantidad necesaria (base);
                                                              FRC=Quantit‚ requise (base);
                                                              ENC=Needed Quantity (Base)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 5540;   ;Reserve             ;Boolean       ;OnValidate=BEGIN
                                                                GetItem;
                                                                IF Item.Reserve <> Item.Reserve::Optional THEN
                                                                  TESTFIELD(Reserve,Item.Reserve = Item.Reserve::Always);
                                                                IF Reserve AND
                                                                   ("Demand Type" = DATABASE::"Prod. Order Component") AND
                                                                   ("Demand Subtype" = ProdOrderCapNeed.Status::Planned)
                                                                THEN
                                                                  ERROR(Text030);
                                                                TESTFIELD("Planning Level",0);
                                                                TESTFIELD("Planning Line Origin","Planning Line Origin"::"Order Planning");
                                                              END;

                                                   CaptionML=[ENU=Reserve;
                                                              ESM=Reserva;
                                                              FRC=R‚server;
                                                              ENC=Reserve] }
    { 5541;   ;Qty. per UOM (Demand);Decimal      ;CaptionML=[ENU=Qty. per UOM (Demand);
                                                              ESM=Cantidad por UM (demanda);
                                                              FRC=Qt‚ par unit‚ (demande);
                                                              ENC=Qty. per UOM (Demand)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5542;   ;Unit Of Measure Code (Demand);Code10;
                                                   TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Unit Of Measure Code (Demand);
                                                              ESM=C¢digo unidad medida (demanda);
                                                              FRC=Code d'unit‚ de mesure (dem.);
                                                              ENC=Unit Of Measure Code (Demand)];
                                                   Editable=No }
    { 5552;   ;Supply From         ;Code20        ;TableRelation=IF (Replenishment System=CONST(Purchase)) Vendor
                                                                 ELSE IF (Replenishment System=CONST(Transfer)) Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                CASE "Replenishment System" OF
                                                                  "Replenishment System"::Purchase:
                                                                    VALIDATE("Vendor No.","Supply From");
                                                                  "Replenishment System"::Transfer:
                                                                    VALIDATE("Transfer-from Code","Supply From");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              CASE "Replenishment System" OF
                                                                "Replenishment System"::Purchase:
                                                                  IF LookupVendor(Vend) THEN
                                                                    VALIDATE("Supply From",Vend."No.");
                                                                "Replenishment System"::Transfer:
                                                                  IF LookupFromLocation(Location) THEN
                                                                    VALIDATE("Supply From",Location.Code);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Supply From;
                                                              ESM=Suministrado desde;
                                                              FRC=Fournisseur;
                                                              ENC=Supply From] }
    { 5553;   ;Original Item No.   ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Original Item No.;
                                                              ESM=N§ de producto original;
                                                              FRC=Nø article d'origine;
                                                              ENC=Original Item No.];
                                                   Editable=No }
    { 5554;   ;Original Variant Code;Code10       ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Original Item No.));
                                                   CaptionML=[ENU=Original Variant Code;
                                                              ESM=C¢digo variante original;
                                                              FRC=Code de variante d'origine;
                                                              ENC=Original Variant Code];
                                                   Editable=No }
    { 5560;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              ESM=Nivel;
                                                              FRC=Niveau;
                                                              ENC=Level];
                                                   Editable=No }
    { 5563;   ;Demand Qty. Available;Decimal      ;CaptionML=[ENU=Demand Qty. Available;
                                                              ESM=Demanda disponible;
                                                              FRC=Qt‚ de demande disponible;
                                                              ENC=Demand Qty. Available];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5590;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              ESM=Id. de usuario;
                                                              FRC=Code utilisateur;
                                                              ENC=User ID];
                                                   Editable=No }
    { 5701;   ;Item Category Code  ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              ESM=C¢d. categor¡a producto;
                                                              FRC=Code cat‚gorie;
                                                              ENC=Item Category Code] }
    { 5702;   ;Nonstock            ;Boolean       ;CaptionML=[ENU=Nonstock;
                                                              ESM=Prod. no inventariable;
                                                              FRC=Non stock‚;
                                                              ENC=Nonstock] }
    { 5703;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              ESM=C¢d. compra;
                                                              FRC=Code achat;
                                                              ENC=Purchasing Code] }
    { 5705;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   CaptionML=[ENU=Product Group Code;
                                                              ESM=C¢d. grupo producto;
                                                              FRC=Code groupe produits;
                                                              ENC=Product Group Code] }
    { 5706;   ;Transfer-from Code  ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                "Supply From" := "Transfer-from Code";
                                                              END;

                                                   CaptionML=[ENU=Transfer-from Code;
                                                              ESM=Transfer. desde-c¢d.;
                                                              FRC=Code prov. transfert;
                                                              ENC=Transfer-from Code];
                                                   Editable=No }
    { 5707;   ;Transfer Shipment Date;Date        ;AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Transfer Shipment Date;
                                                              ESM=Fecha env¡o transfer.;
                                                              FRC=Date livraison transfert;
                                                              ENC=Transfer Shipment Date];
                                                   Editable=No }
    { 7002;   ;Line Discount %     ;Decimal       ;CaptionML=[ENU=Line Discount %;
                                                              ESM=% Descuento l¡nea;
                                                              FRC="Ligne % escompte ";
                                                              ENC=Line Discount %];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 7100;   ;Blanket Purch. Order Exists;Boolean;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purchase Line" WHERE (Document Type=CONST(Blanket Order),
                                                                                            Type=CONST(Item),
                                                                                            No.=FIELD(No.),
                                                                                            Outstanding Quantity=FILTER(<>0)));
                                                   CaptionML=[ENU=Blanket Purch. Order Exists;
                                                              ESM=Existe pedido de compra abierto;
                                                              FRC=La commande achat ouverte existe;
                                                              ENC=Blanket Purch. Order Exists];
                                                   Editable=No }
    { 99000750;;Routing No.        ;Code20        ;TableRelation="Routing Header";
                                                   OnValidate=VAR
                                                                RtngDate@1000 : Date;
                                                              BEGIN
                                                                CheckActionMessageNew;
                                                                "Routing Version Code" := '';

                                                                IF "Routing No." = '' THEN
                                                                  EXIT;

                                                                IF CurrFieldNo = FIELDNO("Starting Date") THEN
                                                                  RtngDate := "Starting Date"
                                                                ELSE
                                                                  RtngDate := "Ending Date";

                                                                VALIDATE("Routing Version Code",VersionMgt.GetRtngVersion("Routing No.",RtngDate,TRUE));
                                                                IF "Routing Version Code" = '' THEN BEGIN
                                                                  RtngHeader.GET("Routing No.");
                                                                  IF PlanningResiliency AND (RtngHeader.Status <> RtngHeader.Status::Certified) THEN
                                                                    TempPlanningErrorLog.SetError(
                                                                      STRSUBSTNO(Text033,RtngHeader.TABLECAPTION,RtngHeader.FIELDCAPTION("No."),RtngHeader."No."),
                                                                      DATABASE::"Routing Header",RtngHeader.GETPOSITION);
                                                                  RtngHeader.TESTFIELD(Status,RtngHeader.Status::Certified);
                                                                  "Routing Type" := RtngHeader.Type;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Routing No.;
                                                              ESM=N§ ruta;
                                                              FRC=Nø itin‚raire;
                                                              ENC=Routing No.] }
    { 99000751;;Operation No.      ;Code10        ;TableRelation="Prod. Order Routing Line"."Operation No." WHERE (Status=CONST(Released),
                                                                                                                   Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                                   Routing No.=FIELD(Routing No.));
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                              BEGIN
                                                                IF "Operation No." = '' THEN
                                                                  EXIT;

                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("Prod. Order No.");
                                                                TESTFIELD("Routing No.");

                                                                ProdOrderRtngLine.GET(
                                                                  ProdOrderRtngLine.Status::Released,
                                                                  "Prod. Order No.",
                                                                  "Routing Reference No.",
                                                                  "Routing No.","Operation No.");

                                                                ProdOrderRtngLine.TESTFIELD(
                                                                  Type,
                                                                  ProdOrderRtngLine.Type::"Work Center");

                                                                "Due Date" := ProdOrderRtngLine."Ending Date";
                                                                CheckDueDateToDemandDate;

                                                                VALIDATE("Work Center No.",ProdOrderRtngLine."No.");

                                                                VALIDATE("Direct Unit Cost",ProdOrderRtngLine."Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Operation No.;
                                                              ESM=N§ operaci¢n;
                                                              FRC=N§ d'activit‚;
                                                              ENC=Operation No.] }
    { 99000752;;Work Center No.    ;Code20        ;TableRelation="Work Center";
                                                   OnValidate=BEGIN
                                                                GetWorkCenter;
                                                                VALIDATE("Vendor No.",WorkCenter."Subcontractor No.");
                                                              END;

                                                   CaptionML=[ENU=Work Center No.;
                                                              ESM=N§ centro trabajo;
                                                              FRC=Atelier n§;
                                                              ENC=Work Centre No.] }
    { 99000754;;Prod. Order Line No.;Integer      ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=CONST(Finished),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.));
                                                   CaptionML=[ENU=Prod. Order Line No.;
                                                              ESM=N§ l¡n. orden producc.;
                                                              FRC=Nø ligne bon prod.;
                                                              ENC=Prod. Order Line No.];
                                                   Editable=No }
    { 99000755;;MPS Order          ;Boolean       ;CaptionML=[ENU=MPS Order;
                                                              ESM=Orden MPS;
                                                              FRC=Commande PDP;
                                                              ENC=MPS Order] }
    { 99000756;;Planning Flexibility;Option       ;OnValidate=BEGIN
                                                                IF "Planning Flexibility" <> xRec."Planning Flexibility" THEN
                                                                  ReserveReqLine.UpdatePlanningFlexibility(Rec);
                                                              END;

                                                   CaptionML=[ENU=Planning Flexibility;
                                                              ESM=Flexib. planificaci¢n;
                                                              FRC=Flexibilit‚ de planification;
                                                              ENC=Planning Flexibility];
                                                   OptionCaptionML=[ENU=Unlimited,None;
                                                                    ESM=Ilimitada,Ninguna;
                                                                    FRC=Illimit‚,Aucun;
                                                                    ENC=Unlimited,None];
                                                   OptionString=Unlimited,None }
    { 99000757;;Routing Reference No.;Integer     ;CaptionML=[ENU=Routing Reference No.;
                                                              ESM=N§ ruta referencia;
                                                              FRC=Nø r‚f‚rence itin‚raire;
                                                              ENC=Routing Reference No.] }
    { 99000882;;Gen. Prod. Posting Group;Code10   ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              ESM=Grupo contable producto;
                                                              FRC=Groupe de report de produit;
                                                              ENC=Gen. Prod. Posting Group] }
    { 99000883;;Gen. Business Posting Group;Code10;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Business Posting Group;
                                                              ESM=Gr. contable negocio;
                                                              FRC=ParamŠtre report march‚;
                                                              ENC=Gen. Business Posting Group] }
    { 99000884;;Low-Level Code     ;Integer       ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Low-Level Code;
                                                              ESM=C¢d. nivel m s bajo;
                                                              FRC=Dernier niveau nomenclature;
                                                              ENC=Low-Level Code];
                                                   Editable=No }
    { 99000885;;Production BOM Version Code;Code20;TableRelation="Production BOM Version"."Version Code" WHERE (Production BOM No.=FIELD(Production BOM No.));
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                IF "Production BOM Version Code" = '' THEN
                                                                  EXIT;

                                                                ProdBOMVersion.GET("Production BOM No.","Production BOM Version Code");
                                                                IF PlanningResiliency AND (ProdBOMVersion.Status <> ProdBOMVersion.Status::Certified) THEN
                                                                  TempPlanningErrorLog.SetError(
                                                                    STRSUBSTNO(
                                                                      Text034,ProdBOMVersion.TABLECAPTION,
                                                                      ProdBOMVersion.FIELDCAPTION("Production BOM No."),ProdBOMVersion."Production BOM No.",
                                                                      ProdBOMVersion.FIELDCAPTION("Version Code"),ProdBOMVersion."Version Code"),
                                                                    DATABASE::"Production BOM Version",ProdBOMVersion.GETPOSITION);
                                                                ProdBOMVersion.TESTFIELD(Status,ProdBOMVersion.Status::Certified);
                                                              END;

                                                   CaptionML=[ENU=Production BOM Version Code;
                                                              ESM=C¢d. versi¢n L.M. producci¢n;
                                                              FRC=Code version nomencl. prod.;
                                                              ENC=Production BOM Version Code] }
    { 99000886;;Routing Version Code;Code20       ;TableRelation="Routing Version"."Version Code" WHERE (Routing No.=FIELD(Routing No.));
                                                   OnValidate=BEGIN
                                                                CheckActionMessageNew;
                                                                IF "Routing Version Code" = '' THEN
                                                                  EXIT;

                                                                RtngVersion.GET("Routing No.","Routing Version Code");
                                                                IF PlanningResiliency AND (RtngVersion.Status <> RtngVersion.Status::Certified) THEN
                                                                  TempPlanningErrorLog.SetError(
                                                                    STRSUBSTNO(
                                                                      Text034,RtngVersion.TABLECAPTION,
                                                                      RtngVersion.FIELDCAPTION("Routing No."),RtngVersion."Routing No.",
                                                                      RtngVersion.FIELDCAPTION("Version Code"),RtngVersion."Version Code"),
                                                                    DATABASE::"Routing Version",RtngVersion.GETPOSITION);
                                                                RtngVersion.TESTFIELD(Status,RtngVersion.Status::Certified);
                                                                "Routing Type" := RtngVersion.Type;
                                                              END;

                                                   CaptionML=[ENU=Routing Version Code;
                                                              ESM=C¢digo versi¢n ruta;
                                                              FRC=Code version d'itin‚raire;
                                                              ENC=Routing Version Code] }
    { 99000887;;Routing Type       ;Option        ;CaptionML=[ENU=Routing Type;
                                                              ESM=Tipo ruta;
                                                              FRC=Type d'itin‚raire;
                                                              ENC=Routing Type];
                                                   OptionCaptionML=[ENU=Serial,Parallel;
                                                                    ESM=En serie,En paralelo;
                                                                    FRC=S‚rie,ParallŠle;
                                                                    ENC=Serial,Parallel];
                                                   OptionString=Serial,Parallel }
    { 99000888;;Original Quantity  ;Decimal       ;CaptionML=[ENU=Original Quantity;
                                                              ESM=Cantidad original;
                                                              FRC=Quantit‚ initiale;
                                                              ENC=Original Quantity];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 99000889;;Finished Quantity  ;Decimal       ;CaptionML=[ENU=Finished Quantity;
                                                              ESM=Cantidad terminada;
                                                              FRC=Quantit‚ achev‚e;
                                                              ENC=Finished Quantity];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 99000890;;Remaining Quantity ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              ESM=Cantidad pendiente;
                                                              FRC=Quantit‚ restante;
                                                              ENC=Remaining Quantity];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 99000891;;Original Due Date  ;Date          ;CaptionML=[ENU=Original Due Date;
                                                              ESM=Fecha vencim. orig.;
                                                              FRC=ch‚ance initiale;
                                                              ENC=Original Due Date];
                                                   Editable=No }
    { 99000892;;Scrap %            ;Decimal       ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Scrap %;
                                                              ESM=% Rechazo;
                                                              FRC=% rebut;
                                                              ENC=Scrap %];
                                                   DecimalPlaces=0:5 }
    { 99000894;;Starting Date      ;Date          ;OnValidate=BEGIN
                                                                IF Type = Type::Item THEN BEGIN
                                                                  GetWorkCenter;
                                                                  IF NOT Subcontracting THEN BEGIN
                                                                    VALIDATE("Production BOM No.");
                                                                    VALIDATE("Routing No.");
                                                                  END;
                                                                  VALIDATE("Starting Time");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              ESM=Fecha inicial;
                                                              FRC=Date d‚but;
                                                              ENC=Starting Date] }
    { 99000895;;Starting Time      ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::Item);
                                                                IF ReqLine.GET("Worksheet Template Name","Journal Batch Name","Line No.") THEN
                                                                  PlngLnMgt.Recalculate(Rec,0)
                                                                ELSE
                                                                  CalcEndingDate('');

                                                                CheckEndingDate(ValidateFields);
                                                                SetDueDate;
                                                                SetActionMessage;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              ESM=Hora inicial;
                                                              FRC=Heure d‚but;
                                                              ENC=Starting Time] }
    { 99000896;;Ending Date        ;Date          ;OnValidate=BEGIN
                                                                CheckEndingDate(ValidateFields);

                                                                IF Type = Type::Item THEN BEGIN
                                                                  VALIDATE("Ending Time");
                                                                  GetWorkCenter;
                                                                  IF NOT Subcontracting THEN BEGIN
                                                                    VALIDATE("Production BOM No.");
                                                                    VALIDATE("Routing No.");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              ESM=Fecha final;
                                                              FRC=Date fin;
                                                              ENC=Ending Date] }
    { 99000897;;Ending Time        ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::Item);
                                                                IF ReqLine.GET("Worksheet Template Name","Journal Batch Name","Line No.") THEN
                                                                  PlngLnMgt.Recalculate(Rec,1)
                                                                ELSE
                                                                  CalcStartingDate('');

                                                                IF (CurrFieldNo IN [FIELDNO("Ending Date"),FIELDNO("Ending Date-Time")]) AND (CurrentFieldNo <> FIELDNO("Due Date")) THEN
                                                                  SetDueDate;
                                                                SetActionMessage;
                                                                IF "Ending Time" = 0T THEN BEGIN
                                                                  MfgSetup.GET;
                                                                  "Ending Time" := MfgSetup."Normal Ending Time";
                                                                END;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              ESM=Hora final;
                                                              FRC=Heure fin;
                                                              ENC=Ending Time] }
    { 99000898;;Production BOM No. ;Code20        ;TableRelation="Production BOM Header".No.;
                                                   OnValidate=VAR
                                                                BOMDate@1000 : Date;
                                                              BEGIN
                                                                TESTFIELD(Type,Type::Item);
                                                                CheckActionMessageNew;
                                                                "Production BOM Version Code" := '';
                                                                IF "Production BOM No." = '' THEN
                                                                  EXIT;

                                                                IF CurrFieldNo = FIELDNO("Starting Date") THEN
                                                                  BOMDate := "Starting Date"
                                                                ELSE
                                                                  BOMDate := "Ending Date";

                                                                VALIDATE("Production BOM Version Code",VersionMgt.GetBOMVersion("Production BOM No.",BOMDate,TRUE));
                                                                IF "Production BOM Version Code" = '' THEN BEGIN
                                                                  ProdBOMHeader.GET("Production BOM No.");
                                                                  IF PlanningResiliency AND (ProdBOMHeader.Status <> ProdBOMHeader.Status::Certified) THEN
                                                                    TempPlanningErrorLog.SetError(
                                                                      STRSUBSTNO(
                                                                        Text033,
                                                                        ProdBOMHeader.TABLECAPTION,
                                                                        ProdBOMHeader.FIELDCAPTION("No."),ProdBOMHeader."No."),
                                                                      DATABASE::"Production BOM Header",ProdBOMHeader.GETPOSITION);

                                                                  ProdBOMHeader.TESTFIELD(Status,ProdBOMHeader.Status::Certified);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Production BOM No.;
                                                              ESM=N§ L.M. producci¢n;
                                                              FRC=Nø production nomenclature;
                                                              ENC=Production BOM No.] }
    { 99000899;;Indirect Cost %    ;Decimal       ;CaptionML=[ENU=Indirect Cost %;
                                                              ESM=% Costo indirecto;
                                                              FRC=% co–t indirect;
                                                              ENC=Indirect Cost %];
                                                   DecimalPlaces=0:5 }
    { 99000900;;Overhead Rate      ;Decimal       ;CaptionML=[ENU=Overhead Rate;
                                                              ESM=Tasa costos generales;
                                                              FRC=Coefficient des frais g‚n.;
                                                              ENC=Overhead Rate];
                                                   DecimalPlaces=0:5 }
    { 99000901;;Unit Cost          ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("No.");

                                                                Item.GET("No.");
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                  "Unit Cost" := Item."Unit Cost" * "Qty. per Unit of Measure";
                                                                END;
                                                                "Cost Amount" := ROUND("Unit Cost" * Quantity);
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              ESM=Costo unitario;
                                                              FRC=Co–t unitaire;
                                                              ENC=Unit Cost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 99000902;;Cost Amount        ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              ESM=Importe costo;
                                                              FRC=Co–t indiqu‚;
                                                              ENC=Cost Amount];
                                                   MinValue=0;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 99000903;;Replenishment System;Option       ;OnValidate=VAR
                                                                AsmHeader@1000 : Record 900;
                                                                NoSeriesMgt@1001 : Codeunit 396;
                                                              BEGIN
                                                                TESTFIELD(Type,Type::Item);
                                                                CheckActionMessageNew;
                                                                IF ValidateFields AND
                                                                   ("Replenishment System" = xRec."Replenishment System") AND
                                                                   ("No." = xRec."No.") AND
                                                                   ("Location Code" = xRec."Location Code") AND
                                                                   ("Variant Code" = xRec."Variant Code")
                                                                THEN
                                                                  EXIT;

                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("No.");
                                                                GetItem;
                                                                GetPlanningParameters.AtSKU(SKU,"No.","Variant Code","Location Code");
                                                                IF Subcontracting THEN
                                                                  SKU."Replenishment System" := SKU."Replenishment System"::"Prod. Order";

                                                                "Supply From" := '';

                                                                CASE "Replenishment System" OF
                                                                  "Replenishment System"::Purchase:
                                                                    BEGIN
                                                                      "Ref. Order Type" := "Ref. Order Type"::Purchase;
                                                                      CLEAR("Ref. Order Status");
                                                                      "Ref. Order No." := '';
                                                                      DeleteRelations;
                                                                      VALIDATE("Production BOM No.",'');
                                                                      VALIDATE("Routing No.",'');
                                                                      IF Item."Purch. Unit of Measure" <> '' THEN
                                                                        VALIDATE("Unit of Measure Code",Item."Purch. Unit of Measure");
                                                                      VALIDATE("Transfer-from Code",'');
                                                                      IF CurrFieldNo = FIELDNO("Location Code") THEN
                                                                        VALIDATE("Vendor No.")
                                                                      ELSE
                                                                        VALIDATE("Vendor No.",SKU."Vendor No.");
                                                                    END;
                                                                  "Replenishment System"::"Prod. Order":
                                                                    BEGIN
                                                                      IF ReqWkshTmpl.GET("Worksheet Template Name") AND (ReqWkshTmpl.Type = ReqWkshTmpl.Type::"Req.") AND
                                                                         (ReqWkshTmpl.Name <> '') AND NOT SourceDropShipment
                                                                      THEN
                                                                        ERROR(ReplenishmentErr);
                                                                      IF PlanningResiliency AND (Item."Base Unit of Measure" = '') THEN
                                                                        TempPlanningErrorLog.SetError(
                                                                          STRSUBSTNO(
                                                                            Text032,Item.TABLECAPTION,Item."No.",
                                                                            Item.FIELDCAPTION("Base Unit of Measure")),
                                                                          DATABASE::Item,Item.GETPOSITION);
                                                                      Item.TESTFIELD("Base Unit of Measure");
                                                                      IF "Ref. Order No." = '' THEN BEGIN
                                                                        "Ref. Order Type" := "Ref. Order Type"::"Prod. Order";
                                                                        "Ref. Order Status" := "Ref. Order Status"::Planned;

                                                                        MfgSetup.GET;
                                                                        IF PlanningResiliency AND (MfgSetup."Planned Order Nos." = '') THEN
                                                                          TempPlanningErrorLog.SetError(
                                                                            STRSUBSTNO(Text032,MfgSetup.TABLECAPTION,'',
                                                                              MfgSetup.FIELDCAPTION("Planned Order Nos.")),
                                                                            DATABASE::"Manufacturing Setup",MfgSetup.GETPOSITION);
                                                                        MfgSetup.TESTFIELD("Planned Order Nos.");

                                                                        IF PlanningResiliency THEN
                                                                          CheckNoSeries(MfgSetup."Planned Order Nos.","Due Date");
                                                                        IF NOT Subcontracting THEN
                                                                          NoSeriesMgt.InitSeries(
                                                                            MfgSetup."Planned Order Nos.",xRec."No. Series","Due Date","Ref. Order No.","No. Series");
                                                                      END;
                                                                      VALIDATE("Vendor No.",'');

                                                                      IF NOT Subcontracting THEN BEGIN
                                                                        IF PlanningResiliency AND
                                                                           ProdBOMHeader.GET(Item."Production BOM No.") AND
                                                                           (ProdBOMHeader.Status <> ProdBOMHeader.Status::Certified)
                                                                        THEN BEGIN
                                                                          TempPlanningErrorLog.SetError(
                                                                            STRSUBSTNO(
                                                                              Text033,ProdBOMHeader.TABLECAPTION,
                                                                              ProdBOMHeader.FIELDCAPTION("No."),ProdBOMHeader."No."),
                                                                            DATABASE::"Production BOM Header",ProdBOMHeader.GETPOSITION);
                                                                          ProdBOMHeader.TESTFIELD(Status,ProdBOMHeader.Status::Certified);
                                                                        END;
                                                                        VALIDATE("Production BOM No.",Item."Production BOM No.");
                                                                        VALIDATE("Routing No.",Item."Routing No.");
                                                                      END ELSE BEGIN
                                                                        "Production BOM No." := Item."Production BOM No.";
                                                                        "Routing No." := Item."Routing No.";
                                                                      END;
                                                                      VALIDATE("Transfer-from Code",'');
                                                                      VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");

                                                                      IF ("Planning Line Origin" = "Planning Line Origin"::"Order Planning") AND
                                                                         ValidateFields
                                                                      THEN
                                                                        PlngLnMgt.Calculate(Rec,1,TRUE,TRUE,0);
                                                                    END;
                                                                  "Replenishment System"::Assembly:
                                                                    BEGIN
                                                                      IF PlanningResiliency AND (Item."Base Unit of Measure" = '') THEN
                                                                        TempPlanningErrorLog.SetError(
                                                                          STRSUBSTNO(
                                                                            Text032,Item.TABLECAPTION,Item."No.",
                                                                            Item.FIELDCAPTION("Base Unit of Measure")),
                                                                          DATABASE::Item,Item.GETPOSITION);
                                                                      Item.TESTFIELD("Base Unit of Measure");
                                                                      IF "Ref. Order No." = '' THEN BEGIN
                                                                        "Ref. Order Type" := "Ref. Order Type"::Assembly;
                                                                        "Ref. Order Status" := AsmHeader."Document Type"::Order;
                                                                      END;
                                                                      VALIDATE("Vendor No.",'');
                                                                      VALIDATE("Production BOM No.",'');
                                                                      VALIDATE("Routing No.",'');
                                                                      VALIDATE("Transfer-from Code",'');
                                                                      VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");

                                                                      IF ("Planning Line Origin" = "Planning Line Origin"::"Order Planning") AND
                                                                         ValidateFields
                                                                      THEN
                                                                        PlngLnMgt.Calculate(Rec,1,TRUE,TRUE,0);
                                                                    END;
                                                                  "Replenishment System"::Transfer:
                                                                    BEGIN
                                                                      "Ref. Order Type" := "Ref. Order Type"::Transfer;
                                                                      CLEAR("Ref. Order Status");
                                                                      "Ref. Order No." := '';
                                                                      DeleteRelations;
                                                                      VALIDATE("Vendor No.",'');
                                                                      VALIDATE("Production BOM No.",'');
                                                                      VALIDATE("Routing No.",'');
                                                                      VALIDATE("Transfer-from Code",SKU."Transfer-from Code");
                                                                      VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Replenishment System;
                                                              ESM=Sistema reposici¢n;
                                                              FRC=SystŠme de r‚approvisionnement;
                                                              ENC=Replenishment System];
                                                   OptionCaptionML=[ENU="Purchase,Prod. Order,Transfer,Assembly, ";
                                                                    ESM="Compra,Orden prod.,Transferencia,Ensamblado, ";
                                                                    FRC="Achat,Bon de production,Transfert,Assemblage, ";
                                                                    ENC="Purchase,Prod. Order,Transfer,Assembly, "];
                                                   OptionString=[Purchase,Prod. Order,Transfer,Assembly, ] }
    { 99000904;;Ref. Order No.     ;Code20        ;TableRelation=IF (Ref. Order Type=CONST(Prod. Order)) "Production Order".No. WHERE (Status=FIELD(Ref. Order Status))
                                                                 ELSE IF (Ref. Order Type=CONST(Purchase)) "Purchase Header".No. WHERE (Document Type=CONST(Order))
                                                                 ELSE IF (Ref. Order Type=CONST(Transfer)) "Transfer Header".No. WHERE (No.=FIELD(Ref. Order No.))
                                                                 ELSE IF (Ref. Order Type=CONST(Assembly)) "Assembly Header".No. WHERE (Document Type=CONST(Order));
                                                   OnLookup=VAR
                                                              PurchHeader@1000 : Record 38;
                                                              ProdOrder@1001 : Record 5405;
                                                              TransHeader@1002 : Record 5740;
                                                              AsmHeader@1003 : Record 900;
                                                            BEGIN
                                                              CASE "Ref. Order Type" OF
                                                                "Ref. Order Type"::Purchase:
                                                                  IF PurchHeader.GET(PurchHeader."Document Type"::Order,"Ref. Order No.") THEN
                                                                    PAGE.RUN(PAGE::"Purchase Order",PurchHeader)
                                                                  ELSE
                                                                    MESSAGE(Text007,PurchHeader.TABLECAPTION);
                                                                "Ref. Order Type"::"Prod. Order":
                                                                  IF ProdOrder.GET("Ref. Order Status","Ref. Order No.") THEN
                                                                    CASE ProdOrder.Status OF
                                                                      ProdOrder.Status::Planned:
                                                                        PAGE.RUN(PAGE::"Planned Production Order",ProdOrder);
                                                                      ProdOrder.Status::"Firm Planned":
                                                                        PAGE.RUN(PAGE::"Firm Planned Prod. Order",ProdOrder);
                                                                      ProdOrder.Status::Released:
                                                                        PAGE.RUN(PAGE::"Released Production Order",ProdOrder);
                                                                    END
                                                                  ELSE
                                                                    MESSAGE(Text007,ProdOrder.TABLECAPTION);
                                                                "Ref. Order Type"::Transfer:
                                                                  IF TransHeader.GET("Ref. Order No.") THEN
                                                                    PAGE.RUN(PAGE::"Transfer Order",TransHeader)
                                                                  ELSE
                                                                    MESSAGE(Text007,TransHeader.TABLECAPTION);
                                                                "Ref. Order Type"::Assembly:
                                                                  IF AsmHeader.GET("Ref. Order Status","Ref. Order No.") THEN
                                                                    PAGE.RUN(PAGE::"Assembly Order",AsmHeader)
                                                                  ELSE
                                                                    MESSAGE(Text007,AsmHeader.TABLECAPTION);
                                                                ELSE
                                                                  MESSAGE(Text008);
                                                              END;
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Ref. Order No.;
                                                              ESM=N§ orden ref.;
                                                              FRC=N§ comm. r‚f.;
                                                              ENC=Ref. Order No.];
                                                   Editable=No }
    { 99000905;;Ref. Order Type    ;Option        ;CaptionML=[ENU=Ref. Order Type;
                                                              ESM=Tipo orden ref.;
                                                              FRC=Type comm. r‚f.;
                                                              ENC=Ref. Order Type];
                                                   OptionCaptionML=[ENU=" ,Purchase,Prod. Order,Transfer,Assembly";
                                                                    ESM=" ,Compra,Orden prod.,Transferencia,Ensamblado";
                                                                    FRC=" ,Achat,Bon de production,Transfert,Assemblage";
                                                                    ENC=" ,Purchase,Prod. Order,Transfer,Assembly"];
                                                   OptionString=[ ,Purchase,Prod. Order,Transfer,Assembly];
                                                   Editable=No }
    { 99000906;;Ref. Order Status  ;Option        ;CaptionML=[ENU=Ref. Order Status;
                                                              ESM=Estado orden ref.;
                                                              FRC=tat comm. r‚f.;
                                                              ENC=Ref. Order Status];
                                                   OptionCaptionML=[ENU=,Planned,Firm Planned,Released;
                                                                    ESM=,Planificada,Planificada en firme,Lanzada;
                                                                    FRC=,Planifi‚,Planifi‚ ferme,Relƒch‚;
                                                                    ENC=,Planned,Firm Planned,Released];
                                                   OptionString=,Planned,Firm Planned,Released;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 99000907;;Ref. Line No.      ;Integer       ;CaptionML=[ENU=Ref. Line No.;
                                                              ESM=N§ l¡n. ref.;
                                                              FRC=Nø ligne r‚f‚rence;
                                                              ENC=Ref. Line No.];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 99000908;;No. Series         ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              ESM=Nos. serie;
                                                              FRC=S‚ries de nø;
                                                              ENC=No. Series];
                                                   Editable=No }
    { 99000909;;Expected Operation Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Planning Routing Line"."Expected Operation Cost Amt." WHERE (Worksheet Template Name=FIELD(Worksheet Template Name),
                                                                                                                                 Worksheet Batch Name=FIELD(Journal Batch Name),
                                                                                                                                 Worksheet Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Expected Operation Cost Amt.;
                                                              ESM=Costo operaci¢n previsto;
                                                              FRC=Co–t fonctionnement pr‚vu;
                                                              ENC=Expected Operation Cost Amt.];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 99000910;;Expected Component Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Planning Component"."Cost Amount" WHERE (Worksheet Template Name=FIELD(Worksheet Template Name),
                                                                                                             Worksheet Batch Name=FIELD(Journal Batch Name),
                                                                                                             Worksheet Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Expected Component Cost Amt.;
                                                              ESM=Costo componente previsto;
                                                              FRC=Co–t pr‚vu composantes;
                                                              ENC=Expected Component Cost Amt.];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 99000911;;Finished Qty. (Base);Decimal      ;CaptionML=[ENU=Finished Qty. (Base);
                                                              ESM=Cdad. terminada (base);
                                                              FRC=Quantit‚ achev‚e (base);
                                                              ENC=Finished Qty. (Base)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000912;;Remaining Qty. (Base);Decimal     ;CaptionML=[ENU=Remaining Qty. (Base);
                                                              ESM=Cdad. pendiente (base);
                                                              FRC=Quantit‚ restante (base);
                                                              ENC=Remaining Qty. (Base)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000913;;Related to Planning Line;Integer  ;CaptionML=[ENU=Related to Planning Line;
                                                              ESM=Relacionado a planif. l¡nea;
                                                              FRC=Assorti … ligne planification;
                                                              ENC=Related to Planning Line];
                                                   Editable=No }
    { 99000914;;Planning Level     ;Integer       ;CaptionML=[ENU=Planning Level;
                                                              ESM=Nivel planif.;
                                                              FRC=Niveau planification;
                                                              ENC=Planning Level];
                                                   Editable=No }
    { 99000915;;Planning Line Origin;Option       ;CaptionML=[ENU=Planning Line Origin;
                                                              ESM=Planif. origen l¡nea;
                                                              FRC=Ligne planification initiale;
                                                              ENC=Planning Line Origin];
                                                   OptionCaptionML=[ENU=" ,Action Message,Planning,Order Planning";
                                                                    ESM=" ,Mensaje acci¢n,Planificaci¢n,planificaci¢n de pedidos";
                                                                    FRC=" ,Message d'action,Planification,Planification de commande";
                                                                    ENC=" ,Action Message,Planning,Order Planning"];
                                                   OptionString=[ ,Action Message,Planning,Order Planning];
                                                   Editable=No }
    { 99000916;;Action Message     ;Option        ;OnValidate=BEGIN
                                                                IF ("Action Message" = xRec."Action Message") OR
                                                                   (("Action Message" IN ["Action Message"::" ","Action Message"::New]) AND
                                                                    (xRec."Action Message" IN ["Action Message"::" ","Action Message"::New]))
                                                                THEN
                                                                  EXIT;
                                                                TESTFIELD("Action Message",xRec."Action Message");
                                                              END;

                                                   CaptionML=[ENU=Action Message;
                                                              ESM=Mensaje acci¢n;
                                                              FRC=Message d'action;
                                                              ENC=Action Message];
                                                   OptionCaptionML=[ENU=" ,New,Change Qty.,Reschedule,Resched. & Chg. Qty.,Cancel";
                                                                    ESM=" ,Nuevo,Cambiar cdad.,Reprogramar,Reprog. y camb. cdad.,Cancelar";
                                                                    FRC=" ,Nouveau,Modifier qt‚,R‚‚chelonner,R‚‚chelonner & modifier qt‚,Annuler";
                                                                    ENC=" ,New,Change Qty.,Reschedule,Resched. & Chg. Qty.,Cancel"];
                                                   OptionString=[ ,New,Change Qty.,Reschedule,Resched. & Chg. Qty.,Cancel] }
    { 99000917;;Accept Action Message;Boolean     ;OnValidate=BEGIN
                                                                IF "Action Message" = "Action Message"::" " THEN
                                                                  VALIDATE("Action Message","Action Message"::New);
                                                              END;

                                                   CaptionML=[ENU=Accept Action Message;
                                                              ESM=Aceptar mensaje acci¢n;
                                                              FRC=Message accepter action;
                                                              ENC=Accept Action Message] }
    { 99000918;;Net Quantity (Base);Decimal       ;CaptionML=[ENU=Net Quantity (Base);
                                                              ESM=Cantidad neta (base);
                                                              FRC=Quantit‚ nette (base);
                                                              ENC=Net Quantity (Base)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000919;;Starting Date-Time ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Date" := DT2DATE("Starting Date-Time");
                                                                "Starting Time" := DT2TIME("Starting Date-Time");

                                                                VALIDATE("Starting Date");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              ESM=Fecha-hora inicial;
                                                              FRC=Date/Heure d‚but;
                                                              ENC=Starting Date-Time] }
    { 99000920;;Ending Date-Time   ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Date" := DT2DATE("Ending Date-Time");
                                                                "Ending Time" := DT2TIME("Ending Date-Time");

                                                                VALIDATE("Ending Date");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              ESM=Fecha-hora final;
                                                              FRC=Date/Heure fin;
                                                              ENC=Ending Date-Time] }
    { 99000921;;Order Promising ID ;Code20        ;CaptionML=[ENU=Order Promising ID;
                                                              ESM=ID promesa pedido;
                                                              FRC=Code promesse livraison;
                                                              ENC=Order Promising ID] }
    { 99000922;;Order Promising Line No.;Integer  ;CaptionML=[ENU=Order Promising Line No.;
                                                              ESM=N§ l¡n. comprom. entrega ped.;
                                                              FRC=Nø ligne promesse livraison;
                                                              ENC=Order Promising Line No.] }
    { 99000923;;Order Promising Line ID;Integer   ;CaptionML=[ENU=Order Promising Line ID;
                                                              ESM=ID l¡n. promesa pedido;
                                                              FRC=Code ligne promesse livraison;
                                                              ENC=Order Promising Line ID] }
  }
  KEYS
  {
    {    ;Worksheet Template Name,Journal Batch Name,Line No.;
                                                   Clustered=Yes }
    {    ;Worksheet Template Name,Journal Batch Name,Vendor No.,Sell-to Customer No.,Ship-to Code,Order Address Code,Currency Code,Ref. Order Type,Ref. Order Status,Ref. Order No.,Location Code,Transfer-from Code;
                                                   MaintainSQLIndex=No }
    {    ;Type,No.,Variant Code,Location Code,Sales Order No.,Planning Line Origin,Due Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Type,No.,Variant Code,Location Code,Sales Order No.,Order Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Type,No.,Variant Code,Location Code,Starting Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Worksheet Template Name,Journal Batch Name,Type,No.,Due Date;
                                                   MaintainSQLIndex=No }
    {    ;Ref. Order Type,Ref. Order Status,Ref. Order No.,Ref. Line No. }
    {    ;Replenishment System,Type,No.,Variant Code,Transfer-from Code,Transfer Shipment Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSQLIndex=No }
    {    ;Order Promising ID,Order Promising Line ID,Order Promising Line No. }
    {    ;User ID,Demand Type,Worksheet Template Name,Journal Batch Name,Line No. }
    {    ;User ID,Demand Type,Demand Subtype,Demand Order No.,Demand Line No.,Demand Ref. No. }
    {    ;User ID,Worksheet Template Name,Journal Batch Name,Line No.;
                                                   MaintainSQLIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text004@1001 : TextConst 'ENU=You cannot rename a %1.;ESM=No se puede cambiar el nombre a %1.;FRC=Vous ne pouvez pas renommer un %1.;ENC=You cannot rename a %1.';
      Text005@1002 : TextConst 'ENU=%1 %2 does not exist.;ESM=No existe %1 %2.;FRC=%1 %2 n''existe pas.;ENC=%1 %2 does not exist.';
      Text006@1003 : TextConst 'ENU=You cannot change %1 when %2 is %3.;ESM=No se puede cambiar %1 cuando %2 es %3.;FRC=Vous ne pouvez modifier %1 lorsque %2 est %3.;ENC=You cannot change %1 when %2 is %3.';
      Text007@1004 : TextConst 'ENU=There is no %1 for this line.;ESM=No hay %1 para esta l¡nea.;FRC=Il n''existe pas d''%1 pour cette ligne.;ENC=There is no %1 for this line.';
      Text008@1005 : TextConst 'ENU=There is no replenishment order for this line.;ESM=No hay orden de reposici¢n para esta l¡nea.;FRC=Il n''y a pas de bon de r‚approvisionnement pour cette ligne.;ENC=There is no replenishment order for this line.';
      ReqWkshTmpl@1006 : Record 244;
      ReqWkshName@1007 : Record 245;
      ReqLine@1008 : Record 246;
      TempReqLine@1009 : Record 246;
      Item@1010 : Record 27;
      SKU@1011 : TEMPORARY Record 5700;
      GLAcc@1012 : Record 15;
      Vend@1013 : Record 23;
      ItemVend@1015 : Record 99;
      ItemTranslation@1016 : Record 30;
      Cust@1017 : Record 18;
      ShipToAddr@1018 : Record 222;
      Currency@1019 : Record 4;
      CurrExchRate@1020 : Record 330;
      ReservEntry@1021 : Record 337;
      ItemVariant@1022 : Record 5401;
      WorkCenter@1023 : Record 99000754;
      TransHeader@1024 : Record 5740;
      PlanningComponent@1047 : Record 99000829;
      PlanningRtngLine@1046 : Record 99000830;
      ProdOrderCapNeed@1045 : Record 5410;
      ProdBOMHeader@1044 : Record 99000771;
      ProdBOMVersion@1043 : Record 99000779;
      RtngHeader@1042 : Record 99000763;
      RtngVersion@1041 : Record 99000786;
      MfgSetup@1040 : Record 99000765;
      Location@1056 : Record 14;
      Bin@1058 : Record 7354;
      PlanningElement@1070 : Record 99000855;
      TempPlanningErrorLog@1030 : TEMPORARY Record 5430;
      Reservation@1025 : Page 498;
      PurchPriceCalcMgt@1014 : Codeunit 7010;
      ReservEngineMgt@1031 : Codeunit 99000831;
      ReserveReqLine@1032 : Codeunit 99000833;
      UOMMgt@1033 : Codeunit 5402;
      AddOnIntegrMgt@1034 : Codeunit 5403;
      DimMgt@1035 : Codeunit 408;
      LeadTimeMgt@1038 : Codeunit 5404;
      GetPlanningParameters@1039 : Codeunit 99000855;
      VersionMgt@1048 : Codeunit 99000756;
      PlngLnMgt@1049 : Codeunit 99000809;
      WMSManagement@1057 : Codeunit 7302;
      CurrentFieldNo@1000 : Integer;
      BlockReservation@1052 : Boolean;
      Text028@1055 : TextConst 'ENU=The %1 on this %2 must match the %1 on the sales order line it is associated with.;ESM=El %1 en este %2 debe coincidir el %1 de la l¡nea del pedido vtas. con el que est  asociado.;FRC=Le %1 de ce %2 doit correspondre au %1 de la ligne du document de vente … laquelle il est associ‚.;ENC=The %1 on this %2 must match the %1 on the sales order line it is associated with.';
      Subcontracting@1029 : Boolean;
      Text029@1036 : TextConst 'ENU=Line %1 has a %2 that exceeds the %3.;ESM=La %2 de la l¡nea %1 supera la %3.;FRC=La ligne %1 a un %2 qui d‚passe le %3.;ENC=Line %1 has a %2 that exceeds the %3.';
      Text030@1037 : TextConst 'ENU=You cannot reserve components with status Planned.;ESM=No es posible reservar un componente cuyo estado sea Planificado.;FRC=Vous ne pouvez pas r‚server des composants dont l''‚tat est Planifi‚;ENC=You cannot reserve components with status Planned.';
      PlanningResiliency@1063 : Boolean;
      Text031@1059 : TextConst 'ENU=%1 %2 is blocked.;ESM=%1 %2 est  bloqueado.;FRC=%1 %2 est bloqu‚.;ENC=%1 %2 is blocked.';
      Text032@1060 : TextConst 'ENU=%1 %2 has no %3 defined.;ESM=%1 %2 no tiene definido %3.;FRC=%1 %2 n''a aucun(e) %3 d‚fini(e).;ENC=%1 %2 has no %3 defined.';
      Text033@1068 : TextConst 'ENU=%1 %2 %3 is not certified.;ESM=%1 %2 %3 no est  certificado.;FRC=%1 %2 %3 n''est pas certifi‚(e).;ENC=%1 %2 %3 is not certified.';
      Text034@1053 : TextConst 'ENU=%1 %2 %3 %4 %5 is not certified.;ESM=%1 %2 %3 %4 %5 no est  certificado.;FRC=%1 %2 %3 %4 %5 n''est pas certifi‚(e).;ENC=%1 %2 %3 %4 %5 is not certified.';
      Text035@1071 : TextConst 'ENU=%1 %2 %3 specified on %4 %5 does not exist.;ESM=No existe %1 %2 %3 especificado en %4 %5.;FRC=%1 %2 %3 pr‚cis‚(e) sur %4 %5 n''existe pas.;ENC=%1 %2 %3 specified on %4 %5 does not exist.';
      Text036@1072 : TextConst 'ENU=%1 %2 %3 does not allow default numbering.;ESM=%1 %2 %3 no admite la numeraci¢n predeterminada.;FRC=%1 %2 %3 ne permet pas la num‚rotation par d‚faut.;ENC=%1 %2 %3 does not allow default numbering.';
      Text037@1065 : TextConst 'ENU=The currency exchange rate for the %1 %2 that vendor %3 uses on the order date %4, does not have an %5 specified.;ESM=El tipo cambio divisa para %1 %2 que el proveedor %3 utiliza en la fecha pedido %4 no especifica %5.;FRC=Le taux de change devise pour le(la) %1 %2 que le fournisseur %3 utilise … la date de commande %4 ne comporte aucun(e) %5.;ENC=The currency exchange rate for the %1 %2 that vendor %3 uses on the order date %4, does not have an %5 specified.';
      Text038@1067 : TextConst 'ENU=The currency exchange rate for the %1 %2 that vendor %3 uses on the order date %4, does not exist.;ESM=El tipo cambio divisa para %1 %2 que el proveedor %3 utiliza en la fecha pedido %4 no existe.;FRC=Le taux de change devise pour le(la) %1 %2 que le fournisseur %3 utilise … la date de commande %4 n''existe pas.;ENC=The currency exchange rate for the %1 %2 that vendor %3 uses on the order date %4, does not exist.';
      Text039@1066 : TextConst 'ENU=You cannot assign new numbers from the number series %1 on %2.;ESM=No puede asignar n£meros nuevos de la serie %1 en la %2.;FRC=Vous ne pouvez affecter de nouveaux num‚ros de la s‚rie de num‚ros %1 … %2.;ENC=You cannot assign new numbers from the number series %1 on %2.';
      Text040@1064 : TextConst 'ENU=You cannot assign new numbers from the number series %1.;ESM=No puede asignar n£meros nuevos de la serie %1.;FRC=Vous ne pouvez affecter de nouveaux num‚ros de la s‚rie de num‚ros %1.;ENC=You cannot assign new numbers from the number series %1.';
      Text041@1062 : TextConst 'ENU=You cannot assign new numbers from the number series %1 on a date before %2.;ESM=No puede asignar n£meros nuevos de la serie %1 en una fecha anterior a %2.;FRC=Vous ne pouvez affecter de nouveaux num‚ros de la s‚rie de num‚ros %1 sur une date avant %2.;ENC=You cannot assign new numbers from the number series %1 on a date before %2.';
      Text042@1054 : TextConst 'ENU=You cannot assign new numbers from the number series %1 line %2 because the %3 is not defined.;ESM=No puede asignar nuevos n£meros del n§ de serie %1, l¡nea %2 porque %3 no est  definido.;FRC=Vous ne pouvez attribuer de nouveaux num‚ros de la s‚rie de num‚ros %1 ligne %2 puisque le(la) %3 n''est pas d‚fini(e).;ENC=You cannot assign new numbers from the number series %1 line %2 because the %3 is not defined.';
      Text043@1061 : TextConst 'ENU=The number %1 on number series %2 cannot be extended to more than 20 characters.;ESM=El n£mero %1 del n§ de serie %2 no puede superar 20 caracteres.;FRC=Le num‚ro %1 de la s‚rie de num‚ros %2 ne peut compter plus de 20 caractŠres.;ENC=The number %1 on number series %2 cannot be extended to more than 20 characters.';
      Text044@1069 : TextConst 'ENU=You cannot assign numbers greater than %1 from the number series %2.;ESM=No puede asignar n£meros mayores que %1 de la serie %2.;FRC=Vous ne pouvez affecter de num‚ros plus grand que %1 de la s‚rie de num‚ros %2.;ENC=You cannot assign numbers greater than %1 from the number series %2.';
      ReplenishmentErr@1073 : TextConst 'ENU=Requisition Worksheet cannot be used to create Prod. Order replenishment.;ESM=La Hoja de demanda no se puede usar para crear la reposici¢n de la orden de producci¢n.;FRC=Une feuille de r‚quisition ne peut pas ˆtre utilis‚e pour cr‚er un r‚approvisionnement O.F.;ENC=Requisition Worksheet cannot be used to create Prod. Order replenishment.';
      SourceDropShipment@1026 : Boolean;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      IF "Prod. Order No." = '' THEN
        TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE GetCurrency@3();
    BEGIN
      IF "Currency Code" = '' THEN BEGIN
        CLEAR(Currency);
        Currency.InitRoundingPrecision;
      END ELSE
        IF "Currency Code" <> Currency.Code THEN
          Currency.GET("Currency Code");
    END;

    LOCAL PROCEDURE GetItem@1();
    BEGIN
      TESTFIELD("No.");
      IF "No." <> Item."No." THEN
        Item.GET("No.");
    END;

    PROCEDURE ShowReservation@4();
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      CLEAR(Reservation);
      Reservation.SetReqLine(Rec);
      Reservation.RUNMODAL;
    END;

    PROCEDURE ShowReservationEntries@6(Modal@1000 : Boolean);
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveReqLine.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    LOCAL PROCEDURE UpdateOrderReceiptDate@5(LeadTimeCalc@1000 : DateFormula);
    BEGIN
      CALCFIELDS("Reserved Qty. (Base)");
      IF "Reserved Qty. (Base)" = 0 THEN BEGIN
        IF "Order Date" <> 0D THEN
          "Starting Date" := "Order Date"
        ELSE BEGIN
          "Starting Date" := WORKDATE;
          "Order Date" := "Starting Date";
        END;
        CalcEndingDate(FORMAT(LeadTimeCalc));
        CheckEndingDate(ValidateFields);
        SetDueDate;
      END ELSE
        IF (FORMAT(LeadTimeCalc) = '') OR ("Due Date" = 0D) THEN
          "Order Date" := 0D
        ELSE
          IF "Due Date" <> 0D THEN BEGIN
            "Ending Date" :=
              LeadTimeMgt.PlannedEndingDate(
                "No.","Location Code","Variant Code","Due Date",'',"Ref. Order Type");
            CalcStartingDate(FORMAT(LeadTimeCalc));
          END;

      SetActionMessage;
      UpdateDatetime;
    END;

    PROCEDURE LookupVendor@43(VAR Vend@1000 : Record 23) : Boolean;
    BEGIN
      IF (Type = Type::Item) AND ItemVend.READPERMISSION THEN BEGIN
        ItemVend.INIT;
        ItemVend.SETRANGE("Item No.","No.");
        ItemVend.SETRANGE("Vendor No.","Vendor No.");
        IF "Variant Code" <> '' THEN
          ItemVend.SETRANGE("Variant Code","Variant Code");
        IF NOT ItemVend.FINDLAST THEN BEGIN
          ItemVend."Item No." := "No.";
          ItemVend."Variant Code" := "Variant Code";
          ItemVend."Vendor No." := "Vendor No.";
        END;
        ItemVend.SETRANGE("Vendor No.");
        IF PAGE.RUNMODAL(0,ItemVend) = ACTION::LookupOK THEN BEGIN
          Vend.GET(ItemVend."Vendor No.");
          EXIT(TRUE);
        END;
        EXIT(FALSE);
      END;
      Vend."No." := "Vendor No.";
      EXIT(PAGE.RUNMODAL(0,Vend) = ACTION::LookupOK);
    END;

    LOCAL PROCEDURE LookupFromLocation@44(VAR Location@1001 : Record 14) : Boolean;
    BEGIN
      Location.Code := "Transfer-from Code";
      Location.SETRANGE("Use As In-Transit",FALSE);
      EXIT(PAGE.RUNMODAL(0,Location) = ACTION::LookupOK);
    END;

    LOCAL PROCEDURE UpdateDescription@8();
    VAR
      ItemVend@1000 : Record 99;
      ItemCrossRef@1001 : Record 5717;
    BEGIN
      IF (Type <> Type::Item) OR ("No." = '') THEN
        EXIT;
      IF "Variant Code" = '' THEN BEGIN
        GetItem;
        Description := Item.Description;
        "Description 2" := Item."Description 2";
      END ELSE BEGIN
        ItemVariant.GET("No.","Variant Code");
        Description := ItemVariant.Description;
        "Description 2" := ItemVariant."Description 2";
      END;
      IF "Vendor No." <> '' THEN BEGIN
        Vend.GET("Vendor No.");
        IF Vend."Language Code" <> '' THEN
          IF ItemTranslation.GET("No.","Variant Code",Vend."Language Code") THEN BEGIN
            Description := ItemTranslation.Description;
            "Description 2" := ItemTranslation."Description 2";
          END;
      END;

      IF (CurrFieldNo <> 0) AND (CurrFieldNo <> FIELDNO("Location Code")) AND
         ("Planning Line Origin" = "Planning Line Origin"::" ")
      THEN
        IF "Vendor No." <> '' THEN BEGIN
          "Location Code" := Vend."Location Code";
          IF ItemVend.GET("Vendor No.","No.","Variant Code") THEN
            IF ItemCrossRef.GET(
                 "No.","Variant Code","Unit of Measure Code",
                 ItemCrossRef."Cross-Reference Type"::Vendor,
                 "Vendor No.",ItemVend."Vendor Item No.")
            THEN
              Description := ItemCrossRef.Description;
        END ELSE
          "Location Code" := '';
    END;

    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      ReserveReqLine.Block(SetBlock);
    END;

    PROCEDURE BlockDynamicTrackingOnComp@29(SetBlock@1000 : Boolean);
    BEGIN
      BlockReservation := SetBlock;
    END;

    LOCAL PROCEDURE CreateDim@2(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20]);
    VAR
      SourceCodeSetup@1004 : Record 242;
      TableID@1005 : ARRAY [10] OF Integer;
      No@1006 : ARRAY [10] OF Code[20];
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableID,No,SourceCodeSetup.Purchases,
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF "Ref. Order No." <> '' THEN
        GetDimFromRefOrderLine(TRUE);
    END;

    PROCEDURE ValidateShortcutDimCode@9(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE LookupShortcutDimCode@10(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@11(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      TESTFIELD("Quantity (Base)");
      ReserveReqLine.CallItemTracking(Rec);
    END;

    PROCEDURE DeleteRelations@35();
    BEGIN
      IF Type <> Type::Item THEN
        EXIT;
      PlanningComponent.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      PlanningComponent.SETRANGE("Worksheet Batch Name","Journal Batch Name");
      PlanningComponent.SETRANGE("Worksheet Line No.","Line No.");
      IF PlanningComponent.FIND('-') THEN
        REPEAT
          PlanningComponent.BlockDynamicTracking(BlockReservation);
          PlanningComponent.DELETE(TRUE);
        UNTIL PlanningComponent.NEXT = 0;

      PlanningRtngLine.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      PlanningRtngLine.SETRANGE("Worksheet Batch Name","Journal Batch Name");
      PlanningRtngLine.SETRANGE("Worksheet Line No.","Line No.");
      IF PlanningRtngLine.FINDFIRST THEN
        PlanningRtngLine.DELETEALL;

      ProdOrderCapNeed.RESET;
      ProdOrderCapNeed.SETCURRENTKEY("Worksheet Template Name","Worksheet Batch Name","Worksheet Line No.");
      ProdOrderCapNeed.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      ProdOrderCapNeed.SETRANGE("Worksheet Batch Name","Journal Batch Name");
      ProdOrderCapNeed.SETRANGE("Worksheet Line No.","Line No.");
      IF ProdOrderCapNeed.FINDFIRST THEN
        ProdOrderCapNeed.DELETEALL;
      ProdOrderCapNeed.RESET;
      ProdOrderCapNeed.SETCURRENTKEY(Status,"Prod. Order No.",Active);
      ProdOrderCapNeed.SETRANGE(Status,"Ref. Order Status");
      ProdOrderCapNeed.SETRANGE("Prod. Order No.","Ref. Order No.");
      ProdOrderCapNeed.SETRANGE(Active,FALSE);
      IF ProdOrderCapNeed.FINDFIRST THEN
        ProdOrderCapNeed.MODIFYALL(Active,TRUE);

      PlanningElement.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      PlanningElement.SETRANGE("Worksheet Batch Name","Journal Batch Name");
      PlanningElement.SETRANGE("Worksheet Line No.","Line No.");
      IF NOT PlanningElement.ISEMPTY THEN
        PlanningElement.DELETEALL;
    END;

    PROCEDURE DeleteMultiLevel@34();
    VAR
      ReqLine2@1000 : Record 246;
    BEGIN
      ReqLine2.SETCURRENTKEY("Ref. Order Type","Ref. Order Status","Ref. Order No.","Ref. Line No.");
      ReqLine2.SETRANGE("Ref. Order Type","Ref. Order Type");
      ReqLine2.SETRANGE("Ref. Order Status","Ref. Order Status");
      ReqLine2.SETRANGE("Ref. Order No.","Ref. Order No.");
      ReqLine2.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      ReqLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
      ReqLine2.SETFILTER("Line No.",'<>%1',"Line No.");
      ReqLine2.SETFILTER("Planning Level",'>0');
      IF ReqLine2.FIND('-') THEN
        REPEAT
          ReserveReqLine.DeleteLine(ReqLine2);
          ReqLine2.CALCFIELDS("Reserved Qty. (Base)");
          ReqLine2.TESTFIELD("Reserved Qty. (Base)",0);
          ReqLine2.DeleteRelations;
          ReqLine2.DELETE;
        UNTIL ReqLine2.NEXT = 0;
    END;

    PROCEDURE SetUpNewLine@32(LastReqLine@1000 : Record 246);
    BEGIN
      ReqWkshTmpl.GET("Worksheet Template Name");
      ReqWkshName.GET("Worksheet Template Name","Journal Batch Name");
      ReqLine.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      ReqLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      IF ReqLine.FIND('-') THEN BEGIN
        "Order Date" := LastReqLine."Order Date";
      END ELSE
        "Order Date" := WORKDATE;

      "Recurring Method" := LastReqLine."Recurring Method";
    END;

    LOCAL PROCEDURE CheckEndingDate@26(ShowWarning@1000 : Boolean);
    VAR
      CheckDateConflict@1001 : Codeunit 99000815;
    BEGIN
      CheckDateConflict.ReqLineCheck(Rec,ShowWarning);
      ReserveReqLine.VerifyChange(Rec,xRec);
    END;

    PROCEDURE SetDueDate@25();
    BEGIN
      IF "Ending Date" = 0D THEN
        EXIT;
      IF (Type = Type::Item) AND
         ("Planning Level" = 0)
      THEN
        "Due Date" :=
          LeadTimeMgt.PlannedDueDate("No.","Location Code","Variant Code","Ending Date",'',"Ref. Order Type")
      ELSE
        "Due Date" := "Ending Date";

      CheckDueDateToDemandDate;
    END;

    PROCEDURE SetCurrFieldNo@63(NewCurrFieldNo@1000 : Integer);
    BEGIN
      CurrentFieldNo := NewCurrFieldNo;
    END;

    LOCAL PROCEDURE CheckDueDateToDemandDate@41();
    BEGIN
      IF ("Planning Line Origin" = "Planning Line Origin"::"Order Planning") AND
         ("Due Date" > "Demand Date") AND
         ("Demand Date" <> 0D) AND
         ValidateFields
      THEN
        MESSAGE(Text029,"Line No.",FIELDCAPTION("Due Date"),FIELDCAPTION("Demand Date"));
    END;

    LOCAL PROCEDURE CheckActionMessageNew@24();
    BEGIN
      IF "Action Message" <> "Action Message"::" " THEN
        IF CurrFieldNo IN [FIELDNO(Type),
                           FIELDNO("No."),
                           FIELDNO("Variant Code"),
                           FIELDNO("Location Code"),
                           FIELDNO("Bin Code"),
                           FIELDNO("Production BOM Version Code"),
                           FIELDNO("Routing Version Code"),
                           FIELDNO("Production BOM No."),
                           FIELDNO("Routing No."),
                           FIELDNO("Replenishment System"),
                           FIELDNO("Unit of Measure Code"),
                           FIELDNO("Vendor No."),
                           FIELDNO("Transfer-from Code")]
        THEN
          TESTFIELD("Action Message","Action Message"::New);
    END;

    PROCEDURE SetActionMessage@23();
    BEGIN
      IF ValidateFields AND
         ("Action Message" <> "Action Message"::" ") AND
         ("Action Message" <> "Action Message"::New)
      THEN BEGIN
        IF (Quantity <> xRec.Quantity) AND ("Original Quantity" = 0) THEN
          "Original Quantity" := xRec.Quantity;
        IF ("Due Date" <> xRec."Due Date") AND ("Original Due Date" = 0D) THEN
          "Original Due Date" := xRec."Due Date";
        IF Quantity = 0 THEN
          "Action Message" := "Action Message"::Cancel
        ELSE
          IF "Original Quantity" <> 0 THEN
            IF "Original Due Date" <> 0D THEN
              "Action Message" := "Action Message"::"Resched. & Chg. Qty."
            ELSE
              "Action Message" := "Action Message"::"Change Qty."
          ELSE
            IF "Original Due Date" <> 0D THEN
              "Action Message" := "Action Message"::Reschedule;

        IF "Action Message" <> xRec."Action Message" THEN
          CLEAR("Planning Line Origin");
      END;
    END;

    LOCAL PROCEDURE ValidateFields@65() : Boolean;
    BEGIN
      EXIT((CurrFieldNo <> 0) OR (CurrentFieldNo <> 0));
    END;

    PROCEDURE GetProdOrderLine@22(ProdOrderLine@1000 : Record 5406);
    VAR
      ProdOrder@1001 : Record 5405;
    BEGIN
      ProdOrderLine.CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
      ProdOrder.GET(ProdOrderLine.Status,ProdOrderLine."Prod. Order No.");
      Item.GET(ProdOrderLine."Item No.");

      TransferFromProdOrderLine(ProdOrderLine);
    END;

    PROCEDURE GetPurchOrderLine@21(PurchOrderLine@1000 : Record 39);
    VAR
      PurchHeader2@1001 : Record 38;
    BEGIN
      IF PurchOrderLine.Type <> PurchOrderLine.Type::Item THEN
        EXIT;
      PurchOrderLine.CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
      PurchHeader2.GET(PurchOrderLine."Document Type",PurchOrderLine."Document No.");
      Item.GET(PurchOrderLine."No.");

      TransferFromPurchaseLine(PurchOrderLine);
    END;

    PROCEDURE GetTransLine@27(TransLine@1000 : Record 5741);
    BEGIN
      TransLine.CALCFIELDS(
        "Reserved Quantity Inbnd.",
        "Reserved Quantity Outbnd.",
        "Reserved Qty. Inbnd. (Base)",
        "Reserved Qty. Outbnd. (Base)");
      TransHeader.GET(TransLine."Document No.");
      Item.GET(TransLine."Item No.");

      TransferFromTransLine(TransLine);
    END;

    PROCEDURE GetAsmHeader@54(AsmHeader@1000 : Record 900);
    VAR
      AsmHeader2@1001 : Record 900;
    BEGIN
      AsmHeader.CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
      AsmHeader2.GET(AsmHeader."Document Type",AsmHeader."No.");
      Item.GET(AsmHeader."Item No.");

      TransferFromAsmHeader(AsmHeader);
    END;

    PROCEDURE GetActionMessages@19();
    VAR
      GetActionMsgReport@1000 : Report 99001023;
    BEGIN
      GetActionMsgReport.SetTemplAndWorksheet("Worksheet Template Name","Journal Batch Name");
      GetActionMsgReport.RUNMODAL;
    END;

    PROCEDURE TransferFromProdOrderLine@18(VAR ProdOrderLine@1000 : Record 5406);
    VAR
      ProdOrder@1001 : Record 5405;
    BEGIN
      ProdOrder.GET(ProdOrderLine.Status,ProdOrderLine."Prod. Order No.");

      Type := Type::Item;
      "No." := ProdOrderLine."Item No.";
      "Variant Code" := ProdOrderLine."Variant Code";
      Description := ProdOrderLine.Description;
      "Description 2" := ProdOrderLine."Description 2";
      "Location Code" := ProdOrderLine."Location Code";
      "Dimension Set ID" := ProdOrderLine."Dimension Set ID";
      "Shortcut Dimension 1 Code" := ProdOrderLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ProdOrderLine."Shortcut Dimension 2 Code";
      "Bin Code" := ProdOrderLine."Bin Code";
      "Gen. Prod. Posting Group" := ProdOrder."Gen. Prod. Posting Group";
      "Gen. Business Posting Group" := ProdOrder."Gen. Bus. Posting Group";
      "Scrap %" := ProdOrderLine."Scrap %";
      "Order Date" := ProdOrder."Creation Date";
      "Starting Time" := ProdOrderLine."Starting Time";
      "Starting Date" := ProdOrderLine."Starting Date";
      "Ending Time" := ProdOrderLine."Ending Time";
      "Ending Date" := ProdOrderLine."Ending Date";
      "Due Date" := ProdOrderLine."Due Date";
      "Production BOM No." := ProdOrderLine."Production BOM No.";
      "Routing No." := ProdOrderLine."Routing No.";
      "Production BOM Version Code" := ProdOrderLine."Production BOM Version Code";
      "Routing Version Code" := ProdOrderLine."Routing Version Code";
      "Routing Type" := ProdOrderLine."Routing Type";
      "Replenishment System" := "Replenishment System"::"Prod. Order";
      Quantity := ProdOrderLine.Quantity;
      "Finished Quantity" := ProdOrderLine."Finished Quantity";
      "Remaining Quantity" := ProdOrderLine."Remaining Quantity";
      "Unit Cost" := ProdOrderLine."Unit Cost";
      "Cost Amount" := ProdOrderLine."Cost Amount";
      "Low-Level Code" := ProdOrder."Low-Level Code";
      "Planning Level" := ProdOrderLine."Planning Level Code";
      "Unit of Measure Code" := ProdOrderLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ProdOrderLine."Qty. per Unit of Measure";
      "Quantity (Base)" := ProdOrderLine."Quantity (Base)";
      "Finished Qty. (Base)" := ProdOrderLine."Finished Qty. (Base)";
      "Remaining Qty. (Base)" := ProdOrderLine."Remaining Qty. (Base)";
      "Indirect Cost %" := ProdOrderLine."Indirect Cost %";
      "Overhead Rate" := ProdOrderLine."Overhead Rate";
      "Expected Operation Cost Amt." := ProdOrderLine."Expected Operation Cost Amt.";
      "Expected Component Cost Amt." := ProdOrderLine."Expected Component Cost Amt.";
      "MPS Order" := ProdOrderLine."MPS Order";
      "Planning Flexibility" := ProdOrderLine."Planning Flexibility";
      "Ref. Order No." := ProdOrderLine."Prod. Order No.";
      "Ref. Order Type" := "Ref. Order Type"::"Prod. Order";
      "Ref. Order Status" := ProdOrderLine.Status;
      "Ref. Line No." := ProdOrderLine."Line No.";

      GetDimFromRefOrderLine(FALSE);
    END;

    PROCEDURE TransferFromPurchaseLine@15(VAR PurchLine@1000 : Record 39);
    VAR
      PurchHeader@1001 : Record 38;
    BEGIN
      PurchHeader.GET(PurchLine."Document Type",PurchLine."Document No.");
      Item.GET(PurchLine."No.");

      Type := Type::Item;
      "No." := PurchLine."No.";
      "Variant Code" := PurchLine."Variant Code";
      Description := PurchLine.Description;
      "Description 2" := PurchLine."Description 2";
      "Location Code" := PurchLine."Location Code";
      "Dimension Set ID" := PurchLine."Dimension Set ID";
      "Shortcut Dimension 1 Code" := PurchLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := PurchLine."Shortcut Dimension 2 Code";
      "Bin Code" := PurchLine."Bin Code";
      "Gen. Prod. Posting Group" := PurchLine."Gen. Prod. Posting Group";
      "Gen. Business Posting Group" := PurchLine."Gen. Bus. Posting Group";
      "Low-Level Code" := Item."Low-Level Code";
      "Order Date" := PurchHeader."Order Date";
      "Starting Date" := "Order Date";
      "Ending Date" := PurchLine."Planned Receipt Date";
      "Due Date" := PurchLine."Expected Receipt Date";
      Quantity := PurchLine.Quantity;
      "Finished Quantity" := PurchLine."Quantity Received";
      "Remaining Quantity" := PurchLine."Outstanding Quantity";
      BlockDynamicTracking(TRUE);
      VALIDATE("Unit Cost",PurchLine."Unit Cost (LCY)");
      BlockDynamicTracking(FALSE);
      "Indirect Cost %" := PurchLine."Indirect Cost %";
      "Overhead Rate" := PurchLine."Overhead Rate";
      "Unit of Measure Code" := PurchLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := PurchLine."Qty. per Unit of Measure";
      "Quantity (Base)" := PurchLine."Quantity (Base)";
      "Finished Qty. (Base)" := PurchLine."Qty. Received (Base)";
      "Remaining Qty. (Base)" := PurchLine."Outstanding Qty. (Base)";
      "Routing No." := PurchLine."Routing No.";
      "Replenishment System" := "Replenishment System"::Purchase;
      "MPS Order" := PurchLine."MPS Order";
      "Planning Flexibility" := PurchLine."Planning Flexibility";
      "Ref. Order No." := PurchLine."Document No.";
      "Ref. Order Type" := "Ref. Order Type"::Purchase;
      "Ref. Line No." := PurchLine."Line No.";
      "Vendor No." := PurchLine."Buy-from Vendor No.";

      GetDimFromRefOrderLine(FALSE);
    END;

    PROCEDURE TransferFromAsmHeader@52(VAR AsmHeader@1000 : Record 900);
    BEGIN
      Item.GET(AsmHeader."Item No.");

      Type := Type::Item;
      "No." := AsmHeader."Item No.";
      "Variant Code" := AsmHeader."Variant Code";
      Description := AsmHeader.Description;
      "Description 2" := AsmHeader."Description 2";
      "Location Code" := AsmHeader."Location Code";
      "Dimension Set ID" := AsmHeader."Dimension Set ID";
      "Shortcut Dimension 1 Code" := AsmHeader."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := AsmHeader."Shortcut Dimension 2 Code";
      "Bin Code" := AsmHeader."Bin Code";
      "Gen. Prod. Posting Group" := AsmHeader."Gen. Prod. Posting Group";
      "Low-Level Code" := Item."Low-Level Code";
      "Order Date" := AsmHeader."Due Date";
      "Starting Date" := "Order Date";
      "Ending Date" := AsmHeader."Due Date";
      "Due Date" := AsmHeader."Due Date";
      Quantity := AsmHeader.Quantity;
      "Finished Quantity" := AsmHeader."Assembled Quantity";
      "Remaining Quantity" := AsmHeader."Remaining Quantity";
      BlockDynamicTracking(TRUE);
      VALIDATE("Unit Cost",AsmHeader."Unit Cost");
      BlockDynamicTracking(FALSE);
      "Indirect Cost %" := AsmHeader."Indirect Cost %";
      "Overhead Rate" := AsmHeader."Overhead Rate";
      "Unit of Measure Code" := AsmHeader."Unit of Measure Code";
      "Qty. per Unit of Measure" := AsmHeader."Qty. per Unit of Measure";
      "Quantity (Base)" := AsmHeader."Quantity (Base)";
      "Finished Qty. (Base)" := AsmHeader."Assembled Quantity (Base)";
      "Remaining Qty. (Base)" := AsmHeader."Remaining Quantity (Base)";
      "Replenishment System" := "Replenishment System"::Assembly;
      "MPS Order" := AsmHeader."MPS Order";
      "Planning Flexibility" := AsmHeader."Planning Flexibility";
      "Ref. Order Type" := "Ref. Order Type"::Assembly;
      "Ref. Order Status" := AsmHeader."Document Type";
      "Ref. Order No." := AsmHeader."No.";
      "Ref. Line No." := 0;

      GetDimFromRefOrderLine(FALSE);
    END;

    PROCEDURE TransferFromTransLine@28(VAR TransLine@1000 : Record 5741);
    BEGIN
      TransHeader.GET(TransLine."Document No.");
      Item.GET(TransLine."Item No.");
      Type := Type::Item;
      "No." := TransLine."Item No.";
      "Variant Code" := TransLine."Variant Code";
      Description := TransLine.Description;
      "Description 2" := TransLine."Description 2";
      "Location Code" := TransLine."Transfer-to Code";
      "Dimension Set ID" := TransLine."Dimension Set ID";
      "Shortcut Dimension 1 Code" := TransLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := TransLine."Shortcut Dimension 2 Code";
      "Gen. Prod. Posting Group" := TransLine."Gen. Prod. Posting Group";
      "Low-Level Code" := Item."Low-Level Code";
      "Starting Date" := CALCDATE(TransLine."Outbound Whse. Handling Time",TransLine."Shipment Date");
      "Ending Date" := CALCDATE(TransLine."Shipping Time","Starting Date");
      "Due Date" := TransLine."Receipt Date";
      Quantity := TransLine.Quantity;
      "Finished Quantity" := TransLine."Quantity Received";
      "Remaining Quantity" := TransLine."Outstanding Quantity";
      BlockDynamicTracking(FALSE);
      "Unit of Measure Code" := TransLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := TransLine."Qty. per Unit of Measure";
      "Quantity (Base)" := TransLine."Quantity (Base)";
      "Finished Qty. (Base)" := TransLine."Qty. Received (Base)";
      "Remaining Qty. (Base)" := TransLine."Outstanding Qty. (Base)";
      "Replenishment System" := "Replenishment System"::Transfer;
      "Ref. Order No." := TransLine."Document No.";
      "Ref. Order Type" := "Ref. Order Type"::Transfer;
      "Ref. Line No." := TransLine."Line No.";
      "Transfer-from Code" := TransLine."Transfer-from Code";
      "Transfer Shipment Date" := TransLine."Shipment Date";
      GetDimFromRefOrderLine(FALSE);
    END;

    PROCEDURE GetDimFromRefOrderLine@30(AddToExisting@1000 : Boolean);
    VAR
      PurchLine@1001 : Record 39;
      ProdOrderLine@1002 : Record 5406;
      TransferLine@1003 : Record 5741;
      AsmHeader@1006 : Record 900;
      DimSetIDArr@1004 : ARRAY [10] OF Integer;
      i@1005 : Integer;
    BEGIN
      IF AddToExisting THEN BEGIN
        i := 1;
        DimSetIDArr[i] := "Dimension Set ID";
      END;
      i := i + 1;

      CASE "Ref. Order Type" OF
        "Ref. Order Type"::Purchase:
          BEGIN
            IF PurchLine.GET(PurchLine."Document Type"::Order,"Ref. Order No.","Ref. Line No.") THEN
              DimSetIDArr[i] := PurchLine."Dimension Set ID"
          END;
        "Ref. Order Type"::"Prod. Order":
          BEGIN
            IF ProdOrderLine.GET("Ref. Order Status","Ref. Order No.","Ref. Line No.") THEN
              DimSetIDArr[i] := ProdOrderLine."Dimension Set ID"
          END;
        "Ref. Order Type"::Transfer:
          BEGIN
            IF TransferLine.GET("Ref. Order No.","Ref. Line No.") THEN
              DimSetIDArr[i] := TransferLine."Dimension Set ID"
          END;
        "Ref. Order Type"::Assembly:
          BEGIN
            IF AsmHeader.GET(AsmHeader."Document Type"::Order,"Ref. Order No.") THEN
              DimSetIDArr[i] := AsmHeader."Dimension Set ID"
          END;
      END;
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE TransferFromActionMessage@13(VAR ActionMessageEntry@1000 : Record 99000849);
    VAR
      ReservEntry@1001 : Record 337;
      EndDate@1002 : Date;
    BEGIN
      IF NOT ReservEntry.GET(ActionMessageEntry."Reservation Entry",TRUE) THEN
        ReservEntry.GET(ActionMessageEntry."Reservation Entry",FALSE);
      BlockDynamicTracking(TRUE);
      Type := Type::Item;
      VALIDATE("No.",ReservEntry."Item No.");
      BlockDynamicTracking(FALSE);
      VALIDATE("Variant Code",ReservEntry."Variant Code");
      VALIDATE("Location Code",ReservEntry."Location Code");
      Description := ReservEntry.Description;

      IF ReservEntry.Positive THEN
        EndDate := ReservEntry."Expected Receipt Date"
      ELSE
        EndDate := ReservEntry."Shipment Date";

      IF EndDate <> 0D THEN
        "Due Date" := EndDate
      ELSE
        "Due Date" := WORKDATE;

      CASE ReservEntry."Source Type" OF
        DATABASE::"Transfer Line",
        DATABASE::"Prod. Order Line",
        DATABASE::"Purchase Line",
        DATABASE::"Requisition Line",
        DATABASE::"Assembly Header":
          "Ending Date" :=
            LeadTimeMgt.PlannedEndingDate(
              ReservEntry."Item No.",
              ReservEntry."Location Code",
              ReservEntry."Variant Code",
              "Due Date",
              "Vendor No.",
              "Ref. Order Type");
      END;
    END;

    PROCEDURE TransferToTrackingEntry@16(VAR TrkgReservEntry@1000 : Record 337;PointerOnly@1001 : Boolean);
    BEGIN
      TrkgReservEntry."Source Type" := DATABASE::"Requisition Line";
      TrkgReservEntry."Source Subtype" := 0;
      TrkgReservEntry."Source ID" := "Worksheet Template Name";
      TrkgReservEntry."Source Batch Name" := "Journal Batch Name";
      TrkgReservEntry."Source Prod. Order Line" := 0;
      TrkgReservEntry."Source Ref. No." := "Line No.";

      IF PointerOnly THEN
        EXIT;
      TrkgReservEntry."Item No." := "No.";
      TrkgReservEntry."Location Code" := "Location Code";
      TrkgReservEntry.Description := '';
      TrkgReservEntry."Creation Date" := TODAY;
      TrkgReservEntry."Created By" := USERID;
      TrkgReservEntry."Qty. per Unit of Measure" := "Qty. per Unit of Measure";
      TrkgReservEntry."Variant Code" := "Variant Code";
      CALCFIELDS("Reserved Quantity");
      TrkgReservEntry.Quantity := "Remaining Quantity" - "Reserved Quantity";
      TrkgReservEntry."Quantity (Base)" := TrkgReservEntry.Quantity * TrkgReservEntry."Qty. per Unit of Measure";

      TrkgReservEntry.Positive := TrkgReservEntry."Quantity (Base)" > 0;

      IF "Planning Level" > 0 THEN
        TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Reservation
      ELSE
        TrkgReservEntry."Reservation Status" := TrkgReservEntry."Reservation Status"::Tracking;

      IF TrkgReservEntry.Positive THEN
        TrkgReservEntry."Expected Receipt Date" := "Due Date"
      ELSE
        TrkgReservEntry."Shipment Date" := "Due Date";
    END;

    PROCEDURE UpdateDatetime@20();
    BEGIN
      "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
      "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
    END;

    LOCAL PROCEDURE GetDirectCost@12(CalledByFieldNo@1000 : Integer);
    BEGIN
      GetWorkCenter;
      IF ("Replenishment System" = "Replenishment System"::Purchase) AND NOT Subcontracting THEN BEGIN
        PurchPriceCalcMgt.FindReqLineDisc(Rec);
        PurchPriceCalcMgt.FindReqLinePrice(Rec,CalledByFieldNo);
      END;
    END;

    LOCAL PROCEDURE ValidateLocationChange@33();
    VAR
      Purchasing@1000 : Record 5721;
      SalesOrderLine@1001 : Record 37;
    BEGIN
      CASE TRUE OF
        "Location Code" = xRec."Location Code":
          EXIT;
        "Purchasing Code" = '':
          EXIT;
        NOT Purchasing.GET("Purchasing Code"):
          EXIT;
        NOT Purchasing."Special Order":
          EXIT;
        NOT SalesOrderLine.GET(SalesOrderLine."Document Type"::Order,"Sales Order No.","Sales Order Line No."):
          EXIT;
        "Location Code" = SalesOrderLine."Location Code":
          EXIT;
      END;

      ERROR(Text028,FIELDCAPTION("Location Code"),TABLECAPTION);
    END;

    PROCEDURE RowID1@49() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(ItemTrackingMgt.ComposeRowID(DATABASE::"Requisition Line",0,"Worksheet Template Name",
          "Journal Batch Name",0,"Line No."));
    END;

    PROCEDURE CalcEndingDate@37(LeadTime@1000 : Code[20]);
    BEGIN
      CASE "Ref. Order Type" OF
        "Ref. Order Type"::Purchase:
          IF LeadTime = '' THEN
            LeadTime := LeadTimeMgt.PurchaseLeadTime("No.","Location Code","Variant Code","Vendor No.");
        "Ref. Order Type"::"Prod. Order",
        "Ref. Order Type"::Assembly:
          BEGIN
            IF RoutingLineExists THEN
              EXIT;

            IF LeadTime = '' THEN
              LeadTime := LeadTimeMgt.ManufacturingLeadTime("No.","Location Code","Variant Code");
          END;
        "Ref. Order Type"::Transfer:
          CalcTransferShipmentDate;
        ELSE
          EXIT;
      END;

      "Ending Date" :=
        LeadTimeMgt.PlannedEndingDate2(
          "No.","Location Code","Variant Code","Vendor No.",LeadTime,"Ref. Order Type","Starting Date");
    END;

    PROCEDURE CalcStartingDate@51(LeadTime@1000 : Code[20]);
    BEGIN
      CASE "Ref. Order Type" OF
        "Ref. Order Type"::Purchase:
          IF LeadTime = '' THEN
            LeadTime :=
              LeadTimeMgt.PurchaseLeadTime(
                "No.","Location Code","Variant Code","Vendor No.");
        "Ref. Order Type"::"Prod. Order",
        "Ref. Order Type"::Assembly:
          BEGIN
            IF RoutingLineExists THEN
              EXIT;

            IF LeadTime = '' THEN
              LeadTime := LeadTimeMgt.ManufacturingLeadTime("No.","Location Code","Variant Code");
          END;
        "Ref. Order Type"::" ":
          EXIT;
      END;

      "Starting Date" :=
        LeadTimeMgt.PlannedStartingDate(
          "No.","Location Code","Variant Code","Vendor No.",LeadTime,"Ref. Order Type","Ending Date");

      VALIDATE("Order Date","Starting Date");

      IF "Ref. Order Type" = "Ref. Order Type"::Transfer THEN
        CalcTransferShipmentDate;
    END;

    LOCAL PROCEDURE CalcTransferShipmentDate@31();
    VAR
      DateFormula@1000 : DateFormula;
      TransferRoute@1001 : Record 5742;
    BEGIN
      EVALUATE(DateFormula,LeadTimeMgt.WhseOutBoundHandlingTime("Transfer-from Code"));
      TransferRoute.CalcShipmentDateBackward("Transfer Shipment Date","Starting Date",DateFormula,"Transfer-from Code");
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    LOCAL PROCEDURE GetBin@7301(LocationCode@1000 : Code[10];BinCode@1001 : Code[20]);
    BEGIN
      IF BinCode = '' THEN
        CLEAR(Bin)
      ELSE
        IF Bin.Code <> BinCode THEN
          Bin.GET(LocationCode,BinCode);
    END;

    PROCEDURE SetSubcontracting@38(IsSubcontracting@1000 : Boolean);
    BEGIN
      Subcontracting := IsSubcontracting;
    END;

    PROCEDURE TransferFromUnplannedDemand@46(VAR UnplannedDemand@1000 : Record 5520);
    BEGIN
      INIT;
      "Line No." := "Line No." + 10000;
      "Planning Line Origin" := "Planning Line Origin"::"Order Planning";

      Type := Type::Item;
      "No." := UnplannedDemand."Item No.";
      "Location Code" := UnplannedDemand."Location Code";
      "Bin Code" := UnplannedDemand."Bin Code";
      VALIDATE("No.");
      VALIDATE("Variant Code",UnplannedDemand."Variant Code");
      UpdateDescription;
      "Unit Of Measure Code (Demand)" := UnplannedDemand."Unit of Measure Code";
      "Qty. per UOM (Demand)" := UnplannedDemand."Qty. per Unit of Measure";
      Reserve := UnplannedDemand.Reserve;

      CASE UnplannedDemand."Demand Type" OF
        UnplannedDemand."Demand Type"::Sales:
          "Demand Type" := DATABASE::"Sales Line";
        UnplannedDemand."Demand Type"::Production:
          "Demand Type" := DATABASE::"Prod. Order Component";
        UnplannedDemand."Demand Type"::Service:
          "Demand Type" := DATABASE::"Service Line";
        UnplannedDemand."Demand Type"::Job:
          "Demand Type" := DATABASE::"Job Planning Line";
        UnplannedDemand."Demand Type"::Assembly:
          "Demand Type" := DATABASE::"Assembly Line";
      END;
      "Demand Subtype" := UnplannedDemand."Demand SubType";
      "Demand Order No." := UnplannedDemand."Demand Order No.";
      "Demand Line No." := UnplannedDemand."Demand Line No.";
      "Demand Ref. No." := UnplannedDemand."Demand Ref. No.";
      IF UnplannedDemand."Special Order" THEN BEGIN
        "Sales Order No." := UnplannedDemand."Demand Order No.";
        "Sales Order Line No." := UnplannedDemand."Demand Line No.";
        "Sell-to Customer No." := UnplannedDemand."Sell-to Customer No.";
        "Purchasing Code" := UnplannedDemand."Purchasing Code";
      END;

      Status := UnplannedDemand.Status;

      Level := 1;
      "Action Message" := ReqLine."Action Message"::New;
      "User ID" := USERID;
    END;

    PROCEDURE SetSupplyDates@45(DemandDate@1000 : Date);
    VAR
      LeadTimeMgt@1001 : Codeunit 5404;
    BEGIN
      "Demand Date" := DemandDate;
      "Starting Date" := "Demand Date";
      "Order Date" := "Demand Date";
      VALIDATE("Due Date","Demand Date");

      IF "Planning Level" = 0 THEN BEGIN
        VALIDATE(
          "Ending Date",
          LeadTimeMgt.PlannedEndingDate(
            "No.","Location Code","Variant Code","Due Date",'',"Ref. Order Type"));
        IF ("Replenishment System" = "Replenishment System"::"Prod. Order") AND ("Starting Time" = 0T) THEN BEGIN
          MfgSetup.GET;
          "Starting Time" := MfgSetup."Normal Starting Time";
        END;
      END ELSE BEGIN
        VALIDATE("Ending Date","Due Date");
        VALIDATE("Ending Time",0T);
      END;
    END;

    PROCEDURE SetSupplyQty@42(DemandQtyBase@1002 : Decimal;NeededQtyBase@1001 : Decimal);
    BEGIN
      IF "Qty. per Unit of Measure" = 0 THEN
        "Qty. per Unit of Measure" := 1;

      "Demand Quantity" := ROUND(DemandQtyBase / "Qty. per Unit of Measure",0.00001);
      "Demand Quantity (Base)" := DemandQtyBase;
      "Needed Quantity" := ROUND(NeededQtyBase / "Qty. per Unit of Measure",0.00001);
      IF "Needed Quantity" < NeededQtyBase / "Qty. per Unit of Measure" THEN
        "Needed Quantity" := ROUND(NeededQtyBase / "Qty. per Unit of Measure",0.00001,'>');
      "Needed Quantity (Base)" := NeededQtyBase;
      "Demand Qty. Available" :=
        ROUND((DemandQtyBase - NeededQtyBase) / "Qty. per Unit of Measure",0.00001);
      VALIDATE(Quantity,"Needed Quantity");
    END;

    PROCEDURE SetResiliencyOn@48(WkshTemplName@1001 : Code[10];JnlBatchName@1000 : Code[10];ItemNo@1002 : Code[20]);
    BEGIN
      PlanningResiliency := TRUE;
      TempPlanningErrorLog.SetJnlBatch(WkshTemplName,JnlBatchName,ItemNo);
    END;

    PROCEDURE GetResiliencyError@47(VAR PlanningErrorLog@1000 : Record 5430) : Boolean;
    BEGIN
      EXIT(TempPlanningErrorLog.GetError(PlanningErrorLog));
    END;

    PROCEDURE SetResiliencyError@39(TheError@1002 : Text[250];TheTableID@1001 : Integer;TheTablePosition@1000 : Text[250]);
    BEGIN
      TempPlanningErrorLog.SetError(TheError,TheTableID,TheTablePosition);
    END;

    LOCAL PROCEDURE CheckExchRate@50();
    VAR
      CurrExchRate@1001 : Record 330;
    BEGIN
      CurrExchRate.SETRANGE("Currency Code","Currency Code");
      CurrExchRate.SETRANGE("Starting Date",0D,"Order Date");
      CASE TRUE OF
        NOT CurrExchRate.FINDLAST:
          TempPlanningErrorLog.SetError(
            STRSUBSTNO(
              Text038,
              Currency.TABLECAPTION,Currency.Code,"Vendor No.","Order Date"),
            DATABASE::Currency,Currency.GETPOSITION);
        CurrExchRate."Exchange Rate Amount" = 0:
          TempPlanningErrorLog.SetError(
            STRSUBSTNO(
              Text037,
              Currency.TABLECAPTION,Currency.Code,"Vendor No.",
              "Order Date",CurrExchRate.FIELDCAPTION("Exchange Rate Amount")),
            DATABASE::Currency,Currency.GETPOSITION);
        CurrExchRate."Relational Exch. Rate Amount" = 0:
          TempPlanningErrorLog.SetError(
            STRSUBSTNO(
              Text037,
              Currency.TABLECAPTION,Currency.Code,"Vendor No.",
              "Order Date",CurrExchRate.FIELDCAPTION("Relational Exch. Rate Amount")),
            DATABASE::Currency,Currency.GETPOSITION);
      END;
    END;

    LOCAL PROCEDURE CheckNoSeries@53(NoSeriesCode@1000 : Code[10];SeriesDate@1001 : Date);
    VAR
      NoSeries@1003 : Record 308;
      NoSeriesLine@1004 : Record 309;
      NoSeriesMgt@1002 : Codeunit 396;
    BEGIN
      CASE TRUE OF
        NOT NoSeries.GET(NoSeriesCode):
          TempPlanningErrorLog.SetError(
            STRSUBSTNO(
              Text035,
              NoSeries.TABLECAPTION,NoSeries.FIELDCAPTION(Code),NoSeriesCode,
              MfgSetup.TABLECAPTION,MfgSetup.FIELDCAPTION("Planned Order Nos.")),
            DATABASE::"No. Series",NoSeries.GETPOSITION);
        NOT NoSeries."Default Nos.":
          TempPlanningErrorLog.SetError(
            STRSUBSTNO(Text036,NoSeries.TABLECAPTION,NoSeries.FIELDCAPTION(Code),NoSeries.Code),
            DATABASE::"No. Series",NoSeries.GETPOSITION);
        ELSE
          IF SeriesDate = 0D THEN
            SeriesDate := WORKDATE;

          NoSeriesMgt.SetNoSeriesLineFilter(NoSeriesLine,NoSeriesCode,SeriesDate);
          IF NOT NoSeriesLine.FINDFIRST THEN BEGIN
            NoSeriesLine.SETRANGE("Starting Date");
            IF NoSeriesLine.FINDFIRST THEN BEGIN
              TempPlanningErrorLog.SetError(
                STRSUBSTNO(Text039,NoSeriesCode,SeriesDate),DATABASE::"No. Series",NoSeries.GETPOSITION);
              EXIT;
            END;
            TempPlanningErrorLog.SetError(
              STRSUBSTNO(Text040,NoSeriesCode),DATABASE::"No. Series",NoSeries.GETPOSITION);
            EXIT;
          END;

          IF NoSeries."Date Order" AND (SeriesDate < NoSeriesLine."Last Date Used") THEN BEGIN
            TempPlanningErrorLog.SetError(
              STRSUBSTNO(Text041,NoSeries.Code,NoSeriesLine."Last Date Used"),
              DATABASE::"No. Series",NoSeries.GETPOSITION);
            EXIT;
          END;
          NoSeriesLine."Last Date Used" := SeriesDate;
          IF NoSeriesLine."Last No. Used" = '' THEN BEGIN
            IF NoSeriesLine."Starting No." = '' THEN BEGIN
              TempPlanningErrorLog.SetError(
                STRSUBSTNO(
                  Text042,
                  NoSeries.Code,NoSeriesLine."Line No.",NoSeriesLine.FIELDCAPTION("Starting No.")),
                DATABASE::"No. Series",NoSeries.GETPOSITION);
              EXIT;
            END;
            NoSeriesLine."Last No. Used" := NoSeriesLine."Starting No.";
          END ELSE
            IF NoSeriesLine."Increment-by No." <= 1 THEN BEGIN
              IF STRLEN(INCSTR(NoSeriesLine."Last No. Used")) > 20 THEN BEGIN
                TempPlanningErrorLog.SetError(
                  STRSUBSTNO(
                    Text043,NoSeriesLine."Last No. Used",NoSeriesCode),
                  DATABASE::"No. Series",NoSeries.GETPOSITION);
                EXIT;
              END;
              NoSeriesLine."Last No. Used" := INCSTR(NoSeriesLine."Last No. Used")
            END ELSE
              IF NOT IncrementNoText(NoSeriesLine."Last No. Used",NoSeriesLine."Increment-by No.") THEN BEGIN
                TempPlanningErrorLog.SetError(
                  STRSUBSTNO(
                    Text043,NoSeriesLine."Last No. Used",NoSeriesCode),
                  DATABASE::"No. Series",NoSeries.GETPOSITION);
                EXIT;
              END;
          IF (NoSeriesLine."Ending No." <> '') AND
             (NoSeriesLine."Last No. Used" > NoSeriesLine."Ending No.")
          THEN
            TempPlanningErrorLog.SetError(
              STRSUBSTNO(Text044,NoSeriesLine."Ending No.",NoSeriesCode),
              DATABASE::"No. Series",NoSeries.GETPOSITION);
      END;
    END;

    LOCAL PROCEDURE IncrementNoText@56(VAR No@1000 : Code[20];IncrementByNo@1001 : Decimal) : Boolean;
    VAR
      DecimalNo@1002 : Decimal;
      StartPos@1003 : Integer;
      EndPos@1004 : Integer;
      NewNo@1005 : Text[30];
    BEGIN
      GetIntegerPos(No,StartPos,EndPos);
      EVALUATE(DecimalNo,COPYSTR(No,StartPos,EndPos - StartPos + 1));
      NewNo := FORMAT(DecimalNo + IncrementByNo,0,1);
      IF NOT ReplaceNoText(No,NewNo,0,StartPos,EndPos) THEN
        EXIT(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ReplaceNoText@55(VAR No@1000 : Code[20];NewNo@1001 : Code[20];FixedLength@1002 : Integer;StartPos@1003 : Integer;EndPos@1004 : Integer) : Boolean;
    VAR
      StartNo@1005 : Code[20];
      EndNo@1006 : Code[20];
      ZeroNo@1007 : Code[20];
      NewLength@1008 : Integer;
      OldLength@1009 : Integer;
    BEGIN
      IF StartPos > 1 THEN
        StartNo := COPYSTR(No,1,StartPos - 1);
      IF EndPos < STRLEN(No) THEN
        EndNo := COPYSTR(No,EndPos + 1);
      NewLength := STRLEN(NewNo);
      OldLength := EndPos - StartPos + 1;
      IF FixedLength > OldLength THEN
        OldLength := FixedLength;
      IF OldLength > NewLength THEN
        ZeroNo := PADSTR('',OldLength - NewLength,'0');
      IF STRLEN(StartNo) + STRLEN(ZeroNo) + STRLEN(NewNo) + STRLEN(EndNo) > 20 THEN
        EXIT(FALSE);
      No := StartNo + ZeroNo + NewNo + EndNo;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetIntegerPos@57(No@1000 : Code[20];VAR StartPos@1001 : Integer;VAR EndPos@1002 : Integer);
    VAR
      IsDigit@1003 : Boolean;
      i@1004 : Integer;
    BEGIN
      StartPos := 0;
      EndPos := 0;
      IF No <> '' THEN BEGIN
        i := STRLEN(No);
        REPEAT
          IsDigit := No[i] IN ['0'..'9'];
          IF IsDigit THEN BEGIN
            IF EndPos = 0 THEN
              EndPos := i;
            StartPos := i;
          END;
          i := i - 1;
        UNTIL (i = 0) OR (StartPos <> 0) AND NOT IsDigit;
      END;
    END;

    LOCAL PROCEDURE FilterLinesWithItemToPlan@70(VAR Item@1000 : Record 27);
    BEGIN
      RESET;
      SETCURRENTKEY(Type,"No.");
      SETRANGE(Type,Type::Item);
      SETRANGE("No.",Item."No.");
      SETRANGE("Sales Order No.",'');
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Due Date",Item.GETFILTER("Date Filter"));
      Item.COPYFILTER("Global Dimension 1 Filter","Shortcut Dimension 1 Code");
      Item.COPYFILTER("Global Dimension 2 Filter","Shortcut Dimension 2 Code");
      SETRANGE("Planning Line Origin","Planning Line Origin"::" ");
      SETFILTER("Quantity (Base)",'<>0');
    END;

    PROCEDURE FindLinesWithItemToPlan@68(VAR Item@1000 : Record 27) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item);
      EXIT(FIND('-'));
    END;

    LOCAL PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item);
      EXIT(NOT ISEMPTY);
    END;

    PROCEDURE FindCurrForecastName@40(VAR ForecastName@1001 : Code[10]) : Boolean;
    VAR
      UntrackedPlngElement@1000 : Record 99000855;
    BEGIN
      IF (Type <> Type::Item) OR
         ("Planning Line Origin" <> "Planning Line Origin"::Planning)
      THEN
        EXIT(FALSE);
      UntrackedPlngElement.SETRANGE("Worksheet Template Name","Worksheet Template Name");
      UntrackedPlngElement.SETRANGE("Worksheet Batch Name","Journal Batch Name");
      UntrackedPlngElement.SETRANGE("Item No.","No.");
      UntrackedPlngElement.SETRANGE("Source Type",DATABASE::"Production Forecast Entry");
      IF UntrackedPlngElement.FINDFIRST THEN BEGIN
        ForecastName := COPYSTR(UntrackedPlngElement."Source ID",1,10);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ShowDimensions@88();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Worksheet Template Name","Journal Batch Name","Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE ShowTimeline@7(ReqLine@1000 : Record 246);
    VAR
      ItemAvailByTimeline@1001 : Page 5540;
    BEGIN
      ReqLine.TESTFIELD(Type,Type::Item);
      ReqLine.TESTFIELD("No.");

      Item.GET("No.");
      Item.SETRANGE("No.",Item."No.");
      Item.SETRANGE("Variant Filter",ReqLine."Variant Code");
      Item.SETRANGE("Location Filter",ReqLine."Location Code");

      ItemAvailByTimeline.SetItem(Item);
      ItemAvailByTimeline.SetWorksheet(ReqLine."Worksheet Template Name",ReqLine."Journal Batch Name");
      ItemAvailByTimeline.RUN;
    END;

    PROCEDURE GetOriginalQtyBase@36() : Decimal;
    BEGIN
      EXIT(CalcBaseQty("Original Quantity"));
    END;

    PROCEDURE SetDropShipment@58(NewDropShipment@1000 : Boolean);
    BEGIN
      SourceDropShipment := NewDropShipment;
    END;

    LOCAL PROCEDURE GetWorkCenter@71();
    BEGIN
      IF WorkCenter."No." = "Work Center No." THEN
        EXIT;

      CLEAR(WorkCenter);
      IF WorkCenter.GET("Work Center No.") THEN
        SetSubcontracting(WorkCenter."Subcontractor No." <> '')
      ELSE
        SetSubcontracting(FALSE);
    END;

    LOCAL PROCEDURE RoutingLineExists@60() : Boolean;
    VAR
      RoutingLine@1000 : Record 99000764;
    BEGIN
      IF "Routing No." <> '' THEN BEGIN
        RoutingLine.SETRANGE("Routing No.","Routing No.");
        EXIT(NOT RoutingLine.ISEMPTY);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    END.
  }
}

